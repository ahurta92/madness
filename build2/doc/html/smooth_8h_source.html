<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MADNESS: smooth.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MADNESS
   &#160;<span id="projectnumber">0.10.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e931c1a3f0014e624d0645a271726ad2.html">examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">smooth.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="smooth_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * smooth.h</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Nov 25, 2015</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kottmanj</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#ifndef SRC_EXAMPLES_SMOOTH_H_</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#define SRC_EXAMPLES_SMOOTH_H_</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nemo_8h.html">chem/nemo.h</a>&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="funcplot_8h.html">madness/mra/funcplot.h</a>&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="SCFOperators_8h.html">chem/SCFOperators.h</a>&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="function__common__data_8h.html">madness/mra/function_common_data.h</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="smooth_8h.html#a25e8e8c37590dd32cd861930584b3790">   19</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a25e8e8c37590dd32cd861930584b3790">RHOMIN</a> = 1.e-20;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="smooth_8h.html#a1c4765f151bca6c2ad5971383fcbcf07">   21</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a1c4765f151bca6c2ad5971383fcbcf07">make_log</a>(<span class="keywordtype">double</span> x){</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">if</span>(x&lt;0.0) <span class="keywordflow">return</span> log(<a class="code" href="smooth_8h.html#a25e8e8c37590dd32cd861930584b3790">RHOMIN</a>);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">return</span> log(x);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="smooth_8h.html#a6e5d4714300cac46f50f52a8abafd65b">   26</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a6e5d4714300cac46f50f52a8abafd65b">make_exp</a>(<span class="keywordtype">double</span> x){</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">return</span> exp(x);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="smooth_8h.html#a441d5e9fcf48aaf1bbf74b4c37d5d85b">   30</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a441d5e9fcf48aaf1bbf74b4c37d5d85b">estimate_area</a>(<span class="keywordtype">double</span> x) {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a> =<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;3&gt;::get_thresh</a>();</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">if</span>(fabs(x)&lt;<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>) <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1.0;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="smooth_8h.html#a5ebd6d861290a2bce2664f4706f1dfca">   36</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a5ebd6d861290a2bce2664f4706f1dfca">test_1d_functor</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_1d</a> &amp;x){</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">return</span> exp(-fabs(x[0]))+0.1*sin(30.0*x[0]);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="smooth_8h.html#a135c4a45a23fef38931d37fff6aa15e1">   40</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a135c4a45a23fef38931d37fff6aa15e1">xf</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;x){</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span> x[1];</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">   43</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">r2</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;x){</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">return</span> x[0]*x[0]+x[1]*x[1]+x[2]*x[2];</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="smooth_8h.html#ae75aa03a85c5549b7c566e4565f0acda">   47</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#ae75aa03a85c5549b7c566e4565f0acda">slater_functor</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;x){</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">double</span> rsq = <a class="code" href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">r2</a>(x);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">double</span> r = sqrt(rsq);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">return</span> exp(-r);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="smooth_8h.html#a405cb6872fc32872ac8cc2eac719aa3f">   53</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a405cb6872fc32872ac8cc2eac719aa3f">mask_factor</a> = 5.0;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="smooth_8h.html#a4493ebd191b7393bb39e7aa937d0f0fd">   54</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a4493ebd191b7393bb39e7aa937d0f0fd">cutoff_radius</a> = 5.0;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//static double mask_functor(const coord_3d &amp;x){</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//  double r = sqrt(r2(x));</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//  //return 1-erf(mask_factor*r);</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//  return 0.5*(1.0 - tanh(mask_factor*(r-cutoff_radius)));</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="smooth_8h.html#a853561c725ea623264b84ebc2a0cc47e">   60</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a853561c725ea623264b84ebc2a0cc47e">mask_functor_box</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;x){</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">double</span> r = sqrt(<a class="code" href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">r2</a>(x));</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//return 1-erf(mask_factor*r);</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">return</span> 0.5*(1.0 - tanh(1.0*(r-15)));</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//static double inv_mask_functor(const coord_3d &amp;x){</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//  double r = sqrt(r2(x));</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//  return 0.5*(1.0 + tanh(mask_factor*(r-cutoff_radius)));</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structmunging__operator.html">   70</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structmunging__operator.html">munging_operator</a> {</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structmunging__operator.html#a5752bd2919249f1b50511e5908a2a7b9">   71</a></span>&#160;    <a class="code" href="structmunging__operator.html#a5752bd2919249f1b50511e5908a2a7b9">munging_operator</a>() : <a class="code" href="structmunging__operator.html#ae8b4a1e0dc3ca17d37162383fcb566be">thresh_</a>(<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults</a>&lt;3&gt;::get_thresh()) {}</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structmunging__operator.html#aa1c9bb6dddac0d6ee556e145b02a4262">   72</a></span>&#160;    <a class="code" href="structmunging__operator.html#aa1c9bb6dddac0d6ee556e145b02a4262">munging_operator</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>) : <a class="code" href="structmunging__operator.html#ae8b4a1e0dc3ca17d37162383fcb566be">thresh_</a>(<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>) {}</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structmunging__operator.html#afd90c31b55ee3a96baa8b8b1c26b8838">   73</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structmunging__operator.html#afd90c31b55ee3a96baa8b8b1c26b8838">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Key.html">Key&lt;3&gt;</a>&amp; key,</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    <a class="code" href="classmadness_1_1Tensor.html">real_tensor</a> U,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">real_tensor</a>&amp; <span class="keyword">function</span>,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">real_tensor</a>&amp; smoothed_function)<span class="keyword"> const </span>{</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="tensor__macros_8h.html#a5d3f3617b9da31368b8c09f1b1ca0c61">ITERATOR</a>(U,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                 <span class="keywordtype">double</span> <a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a> = <span class="keyword">function</span>(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                 <span class="comment">//double sf = smoothed_function(IND);</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                 <span class="keywordflow">if</span> (fabs(<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>)&lt;<a class="code" href="structmunging__operator.html#ae8b4a1e0dc3ca17d37162383fcb566be">thresh_</a>)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                     U(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>) = 0.0;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                 <span class="keywordflow">else</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                     U(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>) = <a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                 );</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Archive&gt;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structmunging__operator.html#a63679b238d38baa254bc1b29d5f373f1">   88</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structmunging__operator.html#a63679b238d38baa254bc1b29d5f373f1">serialize</a>(Archive&amp; ar) {}</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structmunging__operator.html#ae8b4a1e0dc3ca17d37162383fcb566be">   89</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structmunging__operator.html#ae8b4a1e0dc3ca17d37162383fcb566be">thresh_</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;};</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structasymptotic__density.html">   92</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structasymptotic__density.html">asymptotic_density</a>{</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structasymptotic__density.html#a6c43a79ddc04e3a08b18fc0d97600a8f">   94</a></span>&#160;    <a class="code" href="structasymptotic__density.html#a6c43a79ddc04e3a08b18fc0d97600a8f">asymptotic_density</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ie):<a class="code" href="structasymptotic__density.html#acf4d00dcb81dea1e3c8c3ef7bc92ff6a">ionization_energy_</a>(ie), <a class="code" href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">center_of_charge_</a>(0.0){}</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structasymptotic__density.html#a399d3cd984a23ce0715f2ff308648f71">   95</a></span>&#160;    <a class="code" href="structasymptotic__density.html#a399d3cd984a23ce0715f2ff308648f71">asymptotic_density</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ie, <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;coc):<a class="code" href="structasymptotic__density.html#acf4d00dcb81dea1e3c8c3ef7bc92ff6a">ionization_energy_</a>(ie), <a class="code" href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">center_of_charge_</a>(coc){}</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structasymptotic__density.html#a908166e54cd5e886435abad2fb47e48e">   96</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structasymptotic__density.html#a908166e54cd5e886435abad2fb47e48e">operator ()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;x1)<span class="keyword">const</span>{</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> x;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        x[0] = x1[0]-<a class="code" href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">center_of_charge_</a>[0];</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        x[1] = x1[1]-<a class="code" href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">center_of_charge_</a>[1];</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        x[2] = x1[2]-<a class="code" href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">center_of_charge_</a>[2];</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordtype">double</span> r = sqrt((x[0]*x[0]+x[1]*x[1]+x[2]*x[2]));</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordtype">double</span> result= exp(-2.0*sqrt(2.0*fabs(<a class="code" href="structasymptotic__density.html#acf4d00dcb81dea1e3c8c3ef7bc92ff6a">ionization_energy_</a>))*r);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="structasymptotic__density.html#acf4d00dcb81dea1e3c8c3ef7bc92ff6a">  106</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structasymptotic__density.html#acf4d00dcb81dea1e3c8c3ef7bc92ff6a">ionization_energy_</a>;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">  107</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> <a class="code" href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">center_of_charge_</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;};</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structasymptotic__slater__kernel.html">  110</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structasymptotic__slater__kernel.html">asymptotic_slater_kernel</a>{</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structasymptotic__slater__kernel.html#a01732387cdeeed3d5a41e86499faa730">  112</a></span>&#160;    <a class="code" href="structasymptotic__slater__kernel.html#a01732387cdeeed3d5a41e86499faa730">asymptotic_slater_kernel</a>(<span class="keyword">const</span> <a class="code" href="structasymptotic__density.html">asymptotic_density</a> &amp;tmp): <a class="code" href="structasymptotic__slater__kernel.html#a929572b050907018df651c898ddd51d1">asymptotic_rho_</a>(tmp){}</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structasymptotic__slater__kernel.html#aa0f75f251b7abf5c651b678069da2e4b">  114</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structasymptotic__slater__kernel.html#aa0f75f251b7abf5c651b678069da2e4b">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;x)<span class="keyword">const</span>{</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">double</span> prefactor = 1.0/M_PI;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordtype">double</span> r = sqrt((x[0]*x[0]+x[1]*x[1]+x[2]*x[2]));</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">double</span> kernel = prefactor*exp(2.0/3.0*2.0*sqrt(2.0*fabs(<a class="code" href="structasymptotic__slater__kernel.html#a929572b050907018df651c898ddd51d1">asymptotic_rho_</a>.<a class="code" href="structasymptotic__density.html#acf4d00dcb81dea1e3c8c3ef7bc92ff6a">ionization_energy_</a>))*r);<span class="comment">//pow(rho,2.0/3.0);</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">double</span> rho = <a class="code" href="structasymptotic__slater__kernel.html#a929572b050907018df651c898ddd51d1">asymptotic_rho_</a>(x);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">return</span> kernel*rho;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structasymptotic__slater__kernel.html#a929572b050907018df651c898ddd51d1">  123</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structasymptotic__density.html">asymptotic_density</a> <a class="code" href="structasymptotic__slater__kernel.html#a929572b050907018df651c898ddd51d1">asymptotic_rho_</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;};</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structslater__kernel.html">  126</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structslater__kernel.html">slater_kernel</a> {</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="structslater__kernel.html#a19e1f8db9bcbe3e218a8598078bf3439">  127</a></span>&#160;    <a class="code" href="structslater__kernel.html#a19e1f8db9bcbe3e218a8598078bf3439">slater_kernel</a>() : <a class="code" href="structslater__kernel.html#ab00a615a50c92b1cce87786a0078fe30">thresh_</a>(<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults</a>&lt;3&gt;::get_thresh()) {}</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="structslater__kernel.html#a3e87be22e969d5468cbec5bae9105835">  128</a></span>&#160;    <a class="code" href="structslater__kernel.html#a3e87be22e969d5468cbec5bae9105835">slater_kernel</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>) : <a class="code" href="structslater__kernel.html#ab00a615a50c92b1cce87786a0078fe30">thresh_</a>(<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>) {}</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structslater__kernel.html#aed4620d355d24f61c9d5068c5b2d2148">  129</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structslater__kernel.html#aed4620d355d24f61c9d5068c5b2d2148">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Key.html">Key&lt;3&gt;</a>&amp; key,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    <a class="code" href="classmadness_1_1Tensor.html">real_tensor</a> U,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">real_tensor</a>&amp; rho,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">real_tensor</a>&amp; pt_rho)<span class="keyword"> const </span>{</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">double</span> safety = <a class="code" href="structslater__kernel.html#ab00a615a50c92b1cce87786a0078fe30">thresh_</a>*0.01;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">double</span> safety_kernel = <a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(safety,-2.0/3.0);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordtype">double</span> safety_kernel_safety_pd = <a class="code" href="structslater__kernel.html#a5f67a5492cb7728283b7c3af7f0491ac">pre</a>*<a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(safety,1.0/3.0);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="tensor__macros_8h.html#a5d3f3617b9da31368b8c09f1b1ca0c61">ITERATOR</a>(U,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                 <span class="keywordtype">double</span> <a class="code" href="test__sig_8cc.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a> = rho(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                 <span class="keywordtype">double</span> pd = pt_rho(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                 <span class="keywordflow">if</span>(<a class="code" href="test__sig_8cc.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>&lt;safety and fabs(pd)&lt;safety) U(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>)=safety_kernel_safety_pd;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="test__sig_8cc.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>&lt;safety)  U(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>)= <a class="code" href="structslater__kernel.html#a5f67a5492cb7728283b7c3af7f0491ac">pre</a>*safety_kernel*pd;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                 <span class="keywordflow">else</span> U(<a class="code" href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a>) = <a class="code" href="structslater__kernel.html#a5f67a5492cb7728283b7c3af7f0491ac">pre</a>*<a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(<a class="code" href="test__sig_8cc.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>,-2.0/3.0)*pd;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                 );</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Archive&gt;</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structslater__kernel.html#aeb388845539249a7bf79b8292f67f65f">  146</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structslater__kernel.html#aeb388845539249a7bf79b8292f67f65f">serialize</a>(Archive&amp; ar) {}</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structslater__kernel.html#ab00a615a50c92b1cce87786a0078fe30">  147</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structslater__kernel.html#ab00a615a50c92b1cce87786a0078fe30">thresh_</a>;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structslater__kernel.html#a5f67a5492cb7728283b7c3af7f0491ac">  148</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structslater__kernel.html#a5f67a5492cb7728283b7c3af7f0491ac">pre</a> = 1.0/M_PI;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;};</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="smooth_8h.html#a8ffabaced9d4f1a3f30a2a77f3345423">  151</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a8ffabaced9d4f1a3f30a2a77f3345423">analytical_slater_functor</a>(<span class="keywordtype">double</span> rho){</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">double</span> tmp;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span>(rho &lt; 0.0) tmp = 0.0;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">else</span> tmp = <a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(rho,1.0/3.0);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">double</span> prefactor = 1.0/M_PI;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> prefactor*tmp;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="structasymptotic__slater.html">  159</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structasymptotic__slater.html">asymptotic_slater</a> : <span class="keyword">public</span> <a class="code" href="classmadness_1_1FunctionFunctorInterface.html">FunctionFunctorInterface</a>&lt;double,3&gt;{</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="structasymptotic__slater.html#a9439e464a82e55b51047cfed1d314287">  161</a></span>&#160;    <a class="code" href="structasymptotic__slater.html#a9439e464a82e55b51047cfed1d314287">asymptotic_slater</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ipot_): <a class="code" href="structasymptotic__slater.html#a5692b31002011d42aadcbd7221da91b5">ipot</a>(ipot_){}</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structasymptotic__slater.html#a5692b31002011d42aadcbd7221da91b5">  162</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structasymptotic__slater.html#a5692b31002011d42aadcbd7221da91b5">ipot</a>;</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structasymptotic__slater.html#adfb25e91f0e28770713c353d52f0b2a0">  163</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structasymptotic__slater.html#adfb25e91f0e28770713c353d52f0b2a0">prefactor</a> = 1.0/M_PI;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="structasymptotic__slater.html#a081f4939e54b70a1d69843b8e3b4e24f">  165</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structasymptotic__slater.html#a081f4939e54b70a1d69843b8e3b4e24f">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> &amp;x)<span class="keyword">const</span>{</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> r = sqrt((x[0]*x[0]+x[1]*x[1]+x[2]*x[2]));</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> kernel = <a class="code" href="structasymptotic__slater.html#adfb25e91f0e28770713c353d52f0b2a0">prefactor</a>*exp(2.0/3.0*2.0*sqrt(2.0*fabs(<a class="code" href="structasymptotic__slater.html#a5692b31002011d42aadcbd7221da91b5">ipot</a>))*r);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">return</span> kernel;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;};</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html">  172</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structapply__kernel__helper.html">apply_kernel_helper</a>{</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html#a8536a0414683d16a119b185847b373f5">  175</a></span>&#160;    <a class="code" href="structapply__kernel__helper.html#a8536a0414683d16a119b185847b373f5">apply_kernel_helper</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ipot_): <a class="code" href="structapply__kernel__helper.html#a5ecec55d94e4a3bc96a3fb973001515d">ipot</a>(ipot_), <a class="code" href="structapply__kernel__helper.html#aef90e59eb82278ac2fad250482eb0dee">asl</a>(ipot_){}</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="structapply__kernel__helper_1_1slater__kernel.html">  177</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structapply__kernel__helper_1_1slater__kernel.html">slater_kernel</a>{</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="structapply__kernel__helper_1_1slater__kernel.html#a7dd6ae9e19dac9ebc1f481e17fe7c156">  178</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structapply__kernel__helper_1_1slater__kernel.html#a7dd6ae9e19dac9ebc1f481e17fe7c156">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; rho)<span class="keyword">const</span>{</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">double</span> tmp = rho;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">if</span>(tmp&lt;0.0) tmp=1.e-10;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="structapply__kernel__helper_1_1slater__kernel.html#ae27069f7369c0ef0a30cbfada02a1608">prefactor</a>*<a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(tmp,-2.0/3.0);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="structapply__kernel__helper_1_1slater__kernel.html#ae27069f7369c0ef0a30cbfada02a1608">  183</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structapply__kernel__helper_1_1slater__kernel.html#ae27069f7369c0ef0a30cbfada02a1608">prefactor</a> = 1.0/M_PI;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    };</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html#a347a32f3468a49737fd1c275460e4041">  188</a></span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> <a class="code" href="structapply__kernel__helper.html#a347a32f3468a49737fd1c275460e4041">slater_apply</a>(<span class="keyword">const</span> std::vector&lt; <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> &gt;&amp; t,<span class="keyword">const</span> <a class="code" href="classmadness_1_1Key.html">madness::Key&lt;3&gt;</a> &amp; key,<span class="keyword">const</span> <a class="code" href="classmadness_1_1FunctionCommonData.html">FunctionCommonData&lt;double,3&gt;</a> cdata)<span class="keyword"> const</span>{</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> rho = t.front();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> pt_rho = t.back();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <a class="code" href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a> = <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;3&gt;::get_k</a>();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a>&amp; quad_x = cdata.<a class="code" href="classmadness_1_1FunctionCommonData.html#acb9785020960531390e70680562df2df">quad_x</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// if all points of the perturbed density are below the threshold: Set the result to zero</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">bool</span> pt_zero = <span class="keyword">true</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span>(pt_rho.<a class="code" href="classmadness_1_1Tensor.html#a02511feca6bd9e89ebaba8a241ba391c">absmax</a>()&gt;<a class="code" href="structapply__kernel__helper.html#a28c74f7e45da54d409254ce762407d52">safety_thresh_ptrho</a>) pt_zero = <span class="keyword">false</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// fast return if pt_rho is zero</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span>(pt_zero){</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        std::vector&lt;long&gt; kdims(3,<a class="code" href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> zero_result(kdims,<span class="keyword">true</span>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">return</span> zero_result;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// if all points of the unperturbed density are below the threshold: Use asymptotical density</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">bool</span> rho_ana = <span class="keyword">true</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">//if(rho.absmax()&gt;safety_thresh_rho) rho_ana = false;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// analytical kernel based on asymptotical density</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> kernel_val(<a class="code" href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a>,<a class="code" href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a>,<a class="code" href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a>);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span>(rho_ana){</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        madness::fcube&lt;double,3&gt;(key, <a class="code" href="structapply__kernel__helper.html#aef90e59eb82278ac2fad250482eb0dee">asl</a>, quad_x,kernel_val);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        kernel_val = <a class="code" href="namespacemadness.html#a51a0751f3bf95a504c43be228e01b7c2">copy</a>(rho);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="structapply__kernel__helper_1_1slater__kernel.html">slater_kernel</a> slater_tmp;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        kernel_val.<a class="code" href="classmadness_1_1Tensor.html#a9014671cd3e69367d33fa3a2bfa47b63">unaryop</a>&lt;<a class="code" href="structapply__kernel__helper_1_1slater__kernel.html">slater_kernel</a>&gt;(slater_tmp);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// multiply kernel values with pt_rho values</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> result = kernel_val.<a class="code" href="classmadness_1_1Tensor.html#aab540a483f1ac657fd30d841118fefb3">emul</a>(pt_rho);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html#a7ce9b09c07967d9e9eb6c34825da9b0a">  225</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structapply__kernel__helper.html#a7ce9b09c07967d9e9eb6c34825da9b0a">prefactor</a> = 1.0/M_PI;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html#a5ecec55d94e4a3bc96a3fb973001515d">  226</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structapply__kernel__helper.html#a5ecec55d94e4a3bc96a3fb973001515d">ipot</a>;</div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html#aef90e59eb82278ac2fad250482eb0dee">  227</a></span>&#160;    <a class="code" href="structasymptotic__slater.html">asymptotic_slater</a> <a class="code" href="structapply__kernel__helper.html#aef90e59eb82278ac2fad250482eb0dee">asl</a>;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html#a8bdfb403cf388d184a5eea9825a49b15">  228</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structapply__kernel__helper.html#a8bdfb403cf388d184a5eea9825a49b15">safety_thresh_rho</a> = <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;3&gt;::get_thresh</a>()*0.01;</div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structapply__kernel__helper.html#a28c74f7e45da54d409254ce762407d52">  229</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structapply__kernel__helper.html#a28c74f7e45da54d409254ce762407d52">safety_thresh_ptrho</a> = <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;3&gt;::get_thresh</a>()*0.01;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;};</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structslater__kernel__apply.html">  232</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structslater__kernel__apply.html">slater_kernel_apply</a> {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="structslater__kernel__apply.html#a2e4a6a6d7bbfd05e8b1ba3d5f2a0f2f9">  234</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classmadness_1_1FunctionCommonData.html">FunctionCommonData&lt;double,3&gt;</a>&amp; <a class="code" href="structslater__kernel__apply.html#a2e4a6a6d7bbfd05e8b1ba3d5f2a0f2f9">cdata</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structslater__kernel__apply.html#a5e2ac39a8fe9d121471ee6201d5b4bfa">  236</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structapply__kernel__helper.html">apply_kernel_helper</a> *<a class="code" href="structslater__kernel__apply.html#a5e2ac39a8fe9d121471ee6201d5b4bfa">xc</a>;</div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="structslater__kernel__apply.html#a2edf0f5e73e52662375c3092ea4c3410">  237</a></span>&#160;    <a class="code" href="structslater__kernel__apply.html#a2edf0f5e73e52662375c3092ea4c3410">slater_kernel_apply</a>(<span class="keyword">const</span> <a class="code" href="structapply__kernel__helper.html">apply_kernel_helper</a> &amp;xc_) : <a class="code" href="structslater__kernel__apply.html#a2e4a6a6d7bbfd05e8b1ba3d5f2a0f2f9">cdata</a>(<a class="code" href="classmadness_1_1FunctionCommonData.html">FunctionCommonData</a>&lt;double,3&gt;::get(<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults</a>&lt;3&gt;::get_k())), <a class="code" href="structslater__kernel__apply.html#a5e2ac39a8fe9d121471ee6201d5b4bfa">xc</a>(&amp;xc_) {}</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="structslater__kernel__apply.html#a51c223339cc7f975beaff79d9be34f45">  239</a></span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> <a class="code" href="structslater__kernel__apply.html#a51c223339cc7f975beaff79d9be34f45">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Key.html">madness::Key&lt;3&gt;</a> &amp; key,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keyword">const</span> std::vector&lt; <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> &gt;&amp; t)<span class="keyword"> const </span>{</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> r = <a class="code" href="structslater__kernel__apply.html#a5e2ac39a8fe9d121471ee6201d5b4bfa">xc</a>-&gt;<a class="code" href="structapply__kernel__helper.html#a347a32f3468a49737fd1c275460e4041">slater_apply</a>(t,key,<a class="code" href="structslater__kernel__apply.html#a2e4a6a6d7bbfd05e8b1ba3d5f2a0f2f9">cdata</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;};</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structdensity__mask__operator.html">  246</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structdensity__mask__operator.html">density_mask_operator</a>{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structdensity__mask__operator.html#aee506bb2b0f6ef336458a2f43f32eb77">  248</a></span>&#160;    <a class="code" href="structdensity__mask__operator.html#aee506bb2b0f6ef336458a2f43f32eb77">density_mask_operator</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>): <a class="code" href="structdensity__mask__operator.html#a201a4848adc89fd12f79ddb31c84d8eb">safety</a>(<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>){}</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structdensity__mask__operator.html#a330d1ee04c0bf795e3e95609511cca6e">  250</a></span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> <a class="code" href="structdensity__mask__operator.html#a330d1ee04c0bf795e3e95609511cca6e">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Key.html">madness::Key&lt;3&gt;</a> &amp; key,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keyword">const</span> std::vector&lt; <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> &gt;&amp; t)<span class="keyword">const </span>{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> &amp;rho = t.front();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// set result to zero</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> &amp; <a class="code" href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a> = <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;3&gt;::get_k</a>();</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        std::vector&lt;long&gt; kdims(3,<a class="code" href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> result(kdims,<span class="keyword">true</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        result =3.0;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span>(rho.<a class="code" href="classmadness_1_1Tensor.html#a02511feca6bd9e89ebaba8a241ba391c">absmax</a>()&lt;<a class="code" href="structdensity__mask__operator.html#a201a4848adc89fd12f79ddb31c84d8eb">safety</a>){</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            result = 0.0;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            result =1.0;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="structdensity__mask__operator.html#a201a4848adc89fd12f79ddb31c84d8eb">  267</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structdensity__mask__operator.html#a201a4848adc89fd12f79ddb31c84d8eb">safety</a>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;};</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="structmerging__operator.html">  270</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structmerging__operator.html">merging_operator</a>{</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="structmerging__operator.html#aab56718458367ffd4536724d49ebb325">  272</a></span>&#160;    <a class="code" href="structmerging__operator.html#aab56718458367ffd4536724d49ebb325">merging_operator</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="heat_8cc.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>): <a class="code" href="structmerging__operator.html#a1b5aff1f8a9682eeaf037408475f8d14">cutoff</a>(<a class="code" href="heat_8cc.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>){}</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="structmerging__operator.html#a634d5f03cacb8af4008ec630ae92061e">  274</a></span>&#160;    <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> <a class="code" href="structmerging__operator.html#a634d5f03cacb8af4008ec630ae92061e">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Key.html">madness::Key&lt;3&gt;</a> &amp; key,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keyword">const</span> std::vector&lt; <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> &gt;&amp; t)<span class="keyword">const </span>{</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> &amp;<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a> = t.front();</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmadness_1_1Tensor.html">madness::Tensor&lt;double&gt;</a> &amp;sf = t.back();</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>.absmax()&gt;<a class="code" href="structmerging__operator.html#a1b5aff1f8a9682eeaf037408475f8d14">cutoff</a>){</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">return</span> sf;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="structmerging__operator.html#a1b5aff1f8a9682eeaf037408475f8d14">  286</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structmerging__operator.html#a1b5aff1f8a9682eeaf037408475f8d14">cutoff</a>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;};</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword">template</span>&lt;std::<span class="keywordtype">size_t</span> NDIM&gt;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="smooth_8h.html#ae40f714eb1e1602417beebd651af744c">  291</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#ae40f714eb1e1602417beebd651af744c">make_radius</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> &amp;x){</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">r2</a>=0.0;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> <a class="code" href="siam__example_8cc.html#a59ecf5f81b22d6ded9a5a193db5598fd">xi</a>:x) <a class="code" href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">r2</a>+=<a class="code" href="siam__example_8cc.html#a59ecf5f81b22d6ded9a5a193db5598fd">xi</a>*<a class="code" href="siam__example_8cc.html#a59ecf5f81b22d6ded9a5a193db5598fd">xi</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">return</span> sqrt(<a class="code" href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">r2</a>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;}</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">template</span>&lt;std::<span class="keywordtype">size_t</span> NDIM&gt;</div><div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="smooth_8h.html#ad11f8c174dcc4ebcb02dc06a9bed4236">  297</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#ad11f8c174dcc4ebcb02dc06a9bed4236">mask_munging</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x){</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span>(fabs(x)&lt;0.1*<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_thresh</a>()) <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> x;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keyword">template</span>&lt;std::<span class="keywordtype">size_t</span> NDIM&gt;</div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="smooth_8h.html#a521b699706e122afff62769bb740bd27">  302</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a521b699706e122afff62769bb740bd27">unitfunctor</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> &amp;x){</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span> 1.0;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keyword">template</span>&lt;std::<span class="keywordtype">size_t</span> NDIM&gt;</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="smooth_8h.html#a6f2d2bf6d6ea1f87252def5f62f1e6b1">  307</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="smooth_8h.html#a6f2d2bf6d6ea1f87252def5f62f1e6b1">munge</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x){</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span>(fabs(x)&lt;<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_thresh</a>()*0.001) <span class="keywordflow">return</span> 1.e-20;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> x;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, std::<span class="keywordtype">size_t</span> NDIM&gt;</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classsmooth.html">  313</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsmooth.html">smooth</a>{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classsmooth.html#a3b287f9b3552de5100dbf0065784a4ea">  315</a></span>&#160;    <a class="code" href="classsmooth.html#a3b287f9b3552de5100dbf0065784a4ea">smooth</a>(<a class="code" href="classmadness_1_1World.html">World</a>&amp;<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>):</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>){</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classsmooth.html#a704ee523ffad5dab6a3c66c41a3d8d3e">  318</a></span>&#160;    <a class="code" href="classsmooth.html#a704ee523ffad5dab6a3c66c41a3d8d3e">smooth</a>(<a class="code" href="classmadness_1_1World.html">World</a>&amp;<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;box_mask_factor, <span class="keyword">const</span> <span class="keywordtype">double</span> box_mask_cutoff):</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>){</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="structsmooth_1_1mask__functor.html">  322</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structsmooth_1_1mask__functor.html">mask_functor</a>{</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="structsmooth_1_1mask__functor.html#a70a7019e4fedf53d92c39208d9b88821">  324</a></span>&#160;        <a class="code" href="structsmooth_1_1mask__functor.html#a70a7019e4fedf53d92c39208d9b88821">mask_functor</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;factor, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;cutoff): <a class="code" href="structsmooth_1_1mask__functor.html#ab5510524de7611de0dc1d71cce6105bd">factor_</a>(factor), <a class="code" href="structsmooth_1_1mask__functor.html#a3a79e5250b3577ef148afb96b480c07a">cutoff_radius_</a>(cutoff), <a class="code" href="structsmooth_1_1mask__functor.html#a1893f1f198ce68433afb0e9fbdf16459">shift_</a>(0.0){}</div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="structsmooth_1_1mask__functor.html#aa06145aec8ca6aec147dc908dfd0428f">  325</a></span>&#160;        <a class="code" href="structsmooth_1_1mask__functor.html#aa06145aec8ca6aec147dc908dfd0428f">mask_functor</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;factor, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;cutoff, <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> <a class="code" href="helium__mp2_8cc.html#aa62318cb2637a9dfcb106b69c01d669c">shift</a>): <a class="code" href="structsmooth_1_1mask__functor.html#ab5510524de7611de0dc1d71cce6105bd">factor_</a>(factor), <a class="code" href="structsmooth_1_1mask__functor.html#a3a79e5250b3577ef148afb96b480c07a">cutoff_radius_</a>(cutoff), <a class="code" href="structsmooth_1_1mask__functor.html#a1893f1f198ce68433afb0e9fbdf16459">shift_</a>(<a class="code" href="helium__mp2_8cc.html#aa62318cb2637a9dfcb106b69c01d669c">shift</a>){std::cout &lt;&lt; <span class="stringliteral">&quot;shift is &quot;</span> &lt;&lt; <a class="code" href="structsmooth_1_1mask__functor.html#a1893f1f198ce68433afb0e9fbdf16459">shift_</a> &lt;&lt; std::endl;}</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="structsmooth_1_1mask__functor.html#a40f00bcae6fb8c5b1a389880e16fbb33">  326</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structsmooth_1_1mask__functor.html#a40f00bcae6fb8c5b1a389880e16fbb33">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> &amp;x)<span class="keyword">const</span>{</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,3&gt;</a> shifted_x = x-<a class="code" href="structsmooth_1_1mask__functor.html#a1893f1f198ce68433afb0e9fbdf16459">shift_</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> r = make_radius&lt;NDIM&gt;(shifted_x);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">return</span> (1.0-tanh(r));</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="structsmooth_1_1mask__functor.html#ab5510524de7611de0dc1d71cce6105bd">  332</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structsmooth_1_1mask__functor.html#ab5510524de7611de0dc1d71cce6105bd">factor_</a>;</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="structsmooth_1_1mask__functor.html#a3a79e5250b3577ef148afb96b480c07a">  333</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structsmooth_1_1mask__functor.html#a3a79e5250b3577ef148afb96b480c07a">cutoff_radius_</a>;</div><div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="structsmooth_1_1mask__functor.html#a1893f1f198ce68433afb0e9fbdf16459">  334</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> <a class="code" href="structsmooth_1_1mask__functor.html#a1893f1f198ce68433afb0e9fbdf16459">shift_</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    };</div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="structsmooth_1_1inv__mask__functor.html">  336</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structsmooth_1_1inv__mask__functor.html">inv_mask_functor</a>{</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="structsmooth_1_1inv__mask__functor.html#acd9de0a4cc83d57c08f00df40c927093">  338</a></span>&#160;        <a class="code" href="structsmooth_1_1inv__mask__functor.html#acd9de0a4cc83d57c08f00df40c927093">inv_mask_functor</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;factor, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;cutoff): <a class="code" href="structsmooth_1_1inv__mask__functor.html#af5770f4032f65db9b103b17a5f7907f8">factor_</a>(factor), <a class="code" href="structsmooth_1_1inv__mask__functor.html#a0569645a35c04953d025abf557c32a51">cutoff_radius_</a>(cutoff), <a class="code" href="structsmooth_1_1inv__mask__functor.html#aa39b9a160be5e008a869defa9c385d9f">shift_</a>(0.0){}</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="structsmooth_1_1inv__mask__functor.html#aeb8f02431c32f7aabfdcee07bdc4a8f6">  339</a></span>&#160;        <a class="code" href="structsmooth_1_1inv__mask__functor.html#aeb8f02431c32f7aabfdcee07bdc4a8f6">inv_mask_functor</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;factor, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;cutoff, <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> <a class="code" href="helium__mp2_8cc.html#aa62318cb2637a9dfcb106b69c01d669c">shift</a>): <a class="code" href="structsmooth_1_1inv__mask__functor.html#af5770f4032f65db9b103b17a5f7907f8">factor_</a>(factor), <a class="code" href="structsmooth_1_1inv__mask__functor.html#a0569645a35c04953d025abf557c32a51">cutoff_radius_</a>(cutoff), <a class="code" href="structsmooth_1_1inv__mask__functor.html#aa39b9a160be5e008a869defa9c385d9f">shift_</a>(<a class="code" href="helium__mp2_8cc.html#aa62318cb2637a9dfcb106b69c01d669c">shift</a>){}</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="structsmooth_1_1inv__mask__functor.html#a9f602ee33d44ddb476b95df24dba716e">  340</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structsmooth_1_1inv__mask__functor.html#a9f602ee33d44ddb476b95df24dba716e">operator()</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> &amp;x)<span class="keyword">const</span>{</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,3&gt;</a> shifted_x = x-<a class="code" href="structsmooth_1_1inv__mask__functor.html#aa39b9a160be5e008a869defa9c385d9f">shift_</a>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> r = make_radius&lt;NDIM&gt;(shifted_x);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">return</span> 0.5*(1.0 + tanh(<a class="code" href="structsmooth_1_1inv__mask__functor.html#af5770f4032f65db9b103b17a5f7907f8">factor_</a>*(r-<a class="code" href="structsmooth_1_1inv__mask__functor.html#a0569645a35c04953d025abf557c32a51">cutoff_radius_</a>)));</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="structsmooth_1_1inv__mask__functor.html#af5770f4032f65db9b103b17a5f7907f8">  346</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structsmooth_1_1inv__mask__functor.html#af5770f4032f65db9b103b17a5f7907f8">factor_</a>;</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="structsmooth_1_1inv__mask__functor.html#a0569645a35c04953d025abf557c32a51">  347</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="structsmooth_1_1inv__mask__functor.html#a0569645a35c04953d025abf557c32a51">cutoff_radius_</a>;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="structsmooth_1_1inv__mask__functor.html#aa39b9a160be5e008a869defa9c385d9f">  348</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="classmadness_1_1Vector.html">Vector&lt;double,NDIM&gt;</a> <a class="code" href="structsmooth_1_1inv__mask__functor.html#aa39b9a160be5e008a869defa9c385d9f">shift_</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    };</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classsmooth.html#a3fd26a59331e4b853f7d1a5c3e112ce3">  353</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a3fd26a59331e4b853f7d1a5c3e112ce3">smooth_sigma</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;density){</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code" href="testpdiff_8cc.html#a4b6a9b21ba2206c4a0a0bf1ed03c2653">NDIM</a>==3);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Make Sigma\n&quot;</span>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a> = <a class="code" href="classsmooth.html#a998915c296e37f2eb89b516a9f6cb420">make_sigma</a>(density);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(density,<span class="stringliteral">&quot;density&quot;</span>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(<a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>,<span class="stringliteral">&quot;sigma&quot;</span>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> cutoff = <a class="code" href="classsmooth.html#ab3207688ff1f41aa86cb5cbfc8be88e9">get_density_thresh</a>();</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Make Smooth Density\n&quot;</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> smooth_rho = <a class="code" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">cut_oscillations</a>(density,cutoff);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Make Smooth Sigma\n&quot;</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code" href="classsmooth.html#a3fd26a59331e4b853f7d1a5c3e112ce3">smooth_sigma</a> = <a class="code" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">cut_oscillations</a>(<a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>,cutoff);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(<a class="code" href="classsmooth.html#a3fd26a59331e4b853f7d1a5c3e112ce3">smooth_sigma</a>,<span class="stringliteral">&quot;smooth_sigma&quot;</span>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>.print_size(<span class="stringliteral">&quot;sigma&quot;</span>);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="classsmooth.html#a3fd26a59331e4b853f7d1a5c3e112ce3">smooth_sigma</a>.print_size(<span class="stringliteral">&quot;smooth_sigma&quot;</span>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(smooth_rho,<span class="stringliteral">&quot;smooth_density&quot;</span>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classsmooth.html#aa6f70307d0a11c1a546595a87d26d8af">  376</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#aa6f70307d0a11c1a546595a87d26d8af">smooth_density_from_orbitals</a>(<span class="keyword">const</span> std::vector&lt;<a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a>&gt; &amp;orbitals)<span class="keyword">const</span>{</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a> = <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_thresh</a>();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> density = <a class="code" href="classmadness_1_1FunctionFactory.html">FunctionFactory&lt;T,NDIM&gt;</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;orbitals.size();i++){</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> orb = orbitals[i];</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            orb.<a class="code" href="classmadness_1_1Function.html#a097623c0188d0813e8d98be15fea2bcb">refine</a>();</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> boxes = <a class="code" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">cut_oscillations</a>(orb,1000.0,1);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(boxes,<span class="stringliteral">&quot;orbital_sceleton&quot;</span>);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> sf = <a class="code" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">cut_oscillations</a>(orbitals[i],<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>,1);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(sf,<span class="stringliteral">&quot;smooth_orbital_1_&quot;</span>+<a class="code" href="namespacemadness.html#a152e0dfa50065a4289035481210a50d8">stringify</a>(i));</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            sf = <a class="code" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">cut_oscillations</a>(sf,<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>*0.1,1);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(sf,<span class="stringliteral">&quot;smooth_orbital_2_&quot;</span>+<a class="code" href="namespacemadness.html#a152e0dfa50065a4289035481210a50d8">stringify</a>(i));</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            sf = <a class="code" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">cut_oscillations</a>(sf,<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>*0.01,1);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> sf_squared = sf*sf;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            density += sf_squared;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(sf,<span class="stringliteral">&quot;smooth_orbital_3_&quot;</span>+<a class="code" href="namespacemadness.html#a152e0dfa50065a4289035481210a50d8">stringify</a>(i));</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(sf_squared,<span class="stringliteral">&quot;smooth_squared_orbital_&quot;</span>+<a class="code" href="namespacemadness.html#a152e0dfa50065a4289035481210a50d8">stringify</a>(i));</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(density,<span class="stringliteral">&quot;smooth_density&quot;</span>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">return</span> density;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// Function gets linearized if it falls below certain threshold</span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">  399</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">cut_oscillations</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>,<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; cutoff, <span class="keyword">const</span> <span class="keywordtype">size_t</span> order)<span class="keyword">const</span>{</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">// project the function to linear scaling functions</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> lf = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>,order);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        lf = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(lf,<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_k</a>());</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="comment">// merge</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> sf = <a class="code" href="classsmooth.html#af9233848eb0c46f4a2116316d6a67eb7">merge_functions</a>(<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>,lf,cutoff);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">return</span> sf;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="classsmooth.html#a998915c296e37f2eb89b516a9f6cb420">  408</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a998915c296e37f2eb89b516a9f6cb420">make_sigma</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;density)<span class="keyword">const</span>{</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code" href="testpdiff_8cc.html#a4b6a9b21ba2206c4a0a0bf1ed03c2653">NDIM</a>==3);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        std::vector &lt; std::shared_ptr&lt;real_derivative_3d&gt; &gt; <a class="code" href="h2dft_8cc.html#a9323bc3e282df6aafda394f0a9f93d6e">gradop</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <a class="code" href="h2dft_8cc.html#a9323bc3e282df6aafda394f0a9f93d6e">gradop</a> = gradient_operator&lt;double, 3&gt;(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a> = <a class="code" href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">real_factory_3d</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code" href="test__sig_8cc.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>:<a class="code" href="h2dft_8cc.html#a9323bc3e282df6aafda394f0a9f93d6e">gradop</a>){</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            density.<a class="code" href="classmadness_1_1Function.html#a15df9cb8ef447b0f2089f1e829ad8f0b">autorefine</a>();</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> drho = (*d)(density);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            drho.<a class="code" href="classmadness_1_1Function.html#a15df9cb8ef447b0f2089f1e829ad8f0b">autorefine</a>();</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a> += drho*drho;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classsmooth.html#aaf67626f6f17a039b4a757144b4d04cf">  422</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#aaf67626f6f17a039b4a757144b4d04cf">smooth_density</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;density, <span class="keyword">const</span> std::string &amp; msg =<span class="stringliteral">&quot;function&quot;</span>){</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(density,<span class="stringliteral">&quot;density&quot;</span>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">// if thresh is 1.e-x then density thresh is 1.e-2x</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> density_thresh = <a class="code" href="classsmooth.html#ab3207688ff1f41aa86cb5cbfc8be88e9">get_density_thresh</a>();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Density thresh is &quot;</span> &lt;&lt; density_thresh &lt;&lt; std::endl;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> ln_density = <a class="code" href="namespacemadness.html#a51a0751f3bf95a504c43be228e01b7c2">copy</a>(density);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        ln_density.<a class="code" href="classmadness_1_1Function.html#afee4e84afef80e9fe70ebdf6f10199a8">unaryop</a>(<a class="code" href="smooth_8h.html#a1c4765f151bca6c2ad5971383fcbcf07">make_log</a>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(ln_density,<span class="stringliteral">&quot;ln_density&quot;</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> linearized_ln_density = <a class="code" href="classsmooth.html#aeb66e2abb61106bc65a63cd5323bc810">linearize</a>(ln_density);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        linearized_ln_density = <a class="code" href="classsmooth.html#ac5e315de4de66e325c30fa847d9c076b">gaussian_smoothing</a>(linearized_ln_density,0.5,<span class="stringliteral">&quot;linearized_ln_density&quot;</span>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#aaf67626f6f17a039b4a757144b4d04cf">smooth_density</a> = <a class="code" href="namespacemadness.html#a51a0751f3bf95a504c43be228e01b7c2">copy</a>(linearized_ln_density);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="classsmooth.html#aaf67626f6f17a039b4a757144b4d04cf">smooth_density</a>.refine();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="classsmooth.html#aaf67626f6f17a039b4a757144b4d04cf">smooth_density</a>.unaryop(<a class="code" href="smooth_8h.html#a6e5d4714300cac46f50f52a8abafd65b">make_exp</a>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> munged_density = <a class="code" href="classsmooth.html#af9233848eb0c46f4a2116316d6a67eb7">merge_functions</a>(density,<a class="code" href="classsmooth.html#aaf67626f6f17a039b4a757144b4d04cf">smooth_density</a>,<a class="code" href="classsmooth.html#ab3207688ff1f41aa86cb5cbfc8be88e9">get_density_thresh</a>());</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">return</span> munged_density;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classsmooth.html#aeb66e2abb61106bc65a63cd5323bc810">  439</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#aeb66e2abb61106bc65a63cd5323bc810">linearize</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;ln_rho)<span class="keyword">const</span>{</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> linear_ln_rho = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(ln_rho,2);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(linear_ln_rho,<span class="stringliteral">&quot;linear_ln_rho&quot;</span>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> result = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(linear_ln_rho,<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_k</a>());</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(result,<span class="stringliteral">&quot;linear_ln_rho_backprojected&quot;</span>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="classsmooth.html#afd853564ac2b479577cf941fed551276">  447</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#afd853564ac2b479577cf941fed551276">munge_density</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;density)<span class="keyword">const</span>{</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> munged_density = <a class="code" href="namespacemadness.html#a51a0751f3bf95a504c43be228e01b7c2">copy</a>(density);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        munged_density.<a class="code" href="classmadness_1_1Function.html#afee4e84afef80e9fe70ebdf6f10199a8">unaryop</a>(munge&lt;NDIM&gt;);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">return</span> munged_density;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classsmooth.html#a416c0ace94732dd9a6df363526ae4a01">  453</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a416c0ace94732dd9a6df363526ae4a01">make_density_mask</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;density)<span class="keyword">const</span>{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="namespacemadness.html#ac09d6cab7091e6938bdab587ac146bd4">vecfuncT</a> density_wrapper;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        density.<a class="code" href="classmadness_1_1Function.html#aa7fe6957acf8b2a433581209fa9b44b6">reconstruct</a>();</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        density_wrapper.push_back(density);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="structdensity__mask__operator.html">density_mask_operator</a> op_tmp(<a class="code" href="classsmooth.html#ab3207688ff1f41aa86cb5cbfc8be88e9">get_density_thresh</a>());</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> density_mask=multiop_values&lt;double, density_mask_operator, 3&gt;(op_tmp, density_wrapper);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(density_mask,<span class="stringliteral">&quot;density_mask&quot;</span>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">return</span> density_mask;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="classsmooth.html#ab3207688ff1f41aa86cb5cbfc8be88e9">  463</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classsmooth.html#ab3207688ff1f41aa86cb5cbfc8be88e9">get_density_thresh</a>()<span class="keyword">const</span>{</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a> = <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_thresh</a>();</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordtype">double</span> density_thresh = <a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;10;i++){</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordtype">double</span> di = (double) i;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>&gt;<a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(10.0,-di)) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">else</span> density_thresh = <a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(10.0,-2.0*di);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">return</span> density_thresh;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classsmooth.html#a6e7bc943baf0195419e1bba8c75d1add">  474</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a6e7bc943baf0195419e1bba8c75d1add">make_mask</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;samplef, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>)<span class="keyword">const</span>{</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="namespacemadness.html#ac09d6cab7091e6938bdab587ac146bd4">vecfuncT</a> sample_wrapper;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        samplef.<a class="code" href="classmadness_1_1Function.html#aa7fe6957acf8b2a433581209fa9b44b6">reconstruct</a>();</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        sample_wrapper.push_back(samplef);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="structdensity__mask__operator.html">density_mask_operator</a> op_tmp(<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>=multiop_values&lt;double, density_mask_operator, 3&gt;(op_tmp, sample_wrapper);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">// The mask is constant on each box so make shure this will be the case (avoid flutuations)</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> const_mask = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(<a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>,1);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a> = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(const_mask,<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_k</a>());</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(<a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>,<span class="stringliteral">&quot;mask&quot;</span>);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classsmooth.html#a6d0ac83f3fa37fee72c80629419ea6c7">  487</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a6d0ac83f3fa37fee72c80629419ea6c7">make_inv_mask</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;<a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>)<span class="keyword">const</span>{</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> unit = <a class="code" href="classmadness_1_1FunctionFactory.html">FunctionFactory&lt;T,NDIM&gt;</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>).<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>(<a class="code" href="smooth_8h.html#a521b699706e122afff62769bb740bd27">unitfunctor</a>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> inv = unit-<a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> const_inv = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(inv,1);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        inv = <a class="code" href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">project</a>(const_inv,<a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;NDIM&gt;::get_k</a>());</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">return</span> inv;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classsmooth.html#a4031d5e7c73c422f271a132405d8bfce">  495</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a4031d5e7c73c422f271a132405d8bfce">make_explog</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>, <span class="keyword">const</span> std::string &amp; msg=<span class="stringliteral">&quot;function&quot;</span>)<span class="keyword">const</span>{</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">// make logf</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> logf = <a class="code" href="namespacemadness.html#a51a0751f3bf95a504c43be228e01b7c2">copy</a>(<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        logf.<a class="code" href="classmadness_1_1Function.html#afee4e84afef80e9fe70ebdf6f10199a8">unaryop</a>(<a class="code" href="smooth_8h.html#a1c4765f151bca6c2ad5971383fcbcf07">make_log</a>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">// smooth logf</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> smoothed_logf = <a class="code" href="classsmooth.html#ac5e315de4de66e325c30fa847d9c076b">gaussian_smoothing</a>(logf,0.5);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">// reconstruct f via f=exp^(log(f));</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> explogf = <a class="code" href="namespacemadness.html#a51a0751f3bf95a504c43be228e01b7c2">copy</a>(smoothed_logf);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        explogf.<a class="code" href="classmadness_1_1Function.html#afee4e84afef80e9fe70ebdf6f10199a8">unaryop</a>(<a class="code" href="smooth_8h.html#a6e5d4714300cac46f50f52a8abafd65b">make_exp</a>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">// apply the box_mask to eliminate weird boundary effects</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">//explogf = box_mask_*explogf;</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="comment">// make some plots</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>,msg);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(smoothed_logf,<span class="stringliteral">&quot;smoothed_log&quot;</span>+msg);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(logf,<span class="stringliteral">&quot;log&quot;</span>+msg);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(explogf,<span class="stringliteral">&quot;explog_&quot;</span>+msg);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">return</span> explogf;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classsmooth.html#ac5e315de4de66e325c30fa847d9c076b">  518</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#ac5e315de4de66e325c30fa847d9c076b">gaussian_smoothing</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;eps=0.04,<span class="keyword">const</span> std::string &amp;name=<span class="stringliteral">&quot;nooutput&quot;</span>)<span class="keyword">const</span>{</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span>(name!=<span class="stringliteral">&quot;noputput&quot;</span>) <a class="code" href="classsmooth.html#a2c963943ec123fb418e5ea3a83cccd89">output</a>(<span class="stringliteral">&quot;\nSmoothing &quot;</span> + name + <span class="stringliteral">&quot; with eps &quot;</span> + <a class="code" href="namespacemadness.html#a152e0dfa50065a4289035481210a50d8">stringify</a>(eps));</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordtype">double</span> exponent = 1.0/(2.0*eps);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> coeffs(1), exponents(1);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        exponents(0<a class="code" href="ewald_8cc.html#a2442c8274ae11905a74c1bf95501af09">L</a>) =  exponent;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        coeffs(0<a class="code" href="ewald_8cc.html#a2442c8274ae11905a74c1bf95501af09">L</a>) = <a class="code" href="classsmooth.html#a35f729f07bb7ada5d56acc28e914aba0">gauss_norm</a>(exponent);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="classmadness_1_1SeparatedConvolution.html">SeparatedConvolution&lt;T,NDIM&gt;</a> <a class="code" href="kain_8cc.html#ad9ea8219fce53cf10491311a9aac2fc0">op</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>, coeffs, exponents);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> smoothed_f = <a class="code" href="namespacemadness.html#aa30c05e5e017d5c630e8a2210a901a05">apply</a>(<a class="code" href="kain_8cc.html#ad9ea8219fce53cf10491311a9aac2fc0">op</a>,<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(smoothed_f,<span class="stringliteral">&quot;smoothed_&quot;</span>+name);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">return</span> smoothed_f;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classsmooth.html#af9233848eb0c46f4a2116316d6a67eb7">  531</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#af9233848eb0c46f4a2116316d6a67eb7">merge_functions</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>, <span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;sf,<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;<a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>,<span class="keyword">const</span> std::string &amp;name=<span class="stringliteral">&quot;f&quot;</span>)<span class="keyword">const</span>{</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> inv_mask = <a class="code" href="classsmooth.html#a6d0ac83f3fa37fee72c80629419ea6c7">make_inv_mask</a>(<a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> part1 = <a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>*<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> part2 = inv_mask*sf;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> result = part1 + part2;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(<a class="code" href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a>,<span class="stringliteral">&quot;mask_&quot;</span>+name);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(inv_mask,<span class="stringliteral">&quot;inv_mask_&quot;</span>+name);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(part1,<span class="stringliteral">&quot;masked_&quot;</span>+name);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(part2,<span class="stringliteral">&quot;masked_s&quot;</span>+name);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="classsmooth.html#a81b11b3934c624196dc66db76e89bdf9">  543</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a81b11b3934c624196dc66db76e89bdf9">merge_functions</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a>&amp;<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>, <span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a>&amp;sf, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>)<span class="keyword">const</span>{</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code" href="testpdiff_8cc.html#a4b6a9b21ba2206c4a0a0bf1ed03c2653">NDIM</a>==3);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="namespacemadness.html#ac09d6cab7091e6938bdab587ac146bd4">vecfuncT</a> wrapper;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        wrapper.push_back(<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        wrapper.push_back(sf);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="namespacemadness.html#ac120a84f8cef7455f8d9bc68214e0c62">refine_to_common_level</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>,wrapper);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="structmerging__operator.html">merging_operator</a> op_tmp(<a class="code" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_3d</a> merged_f=multiop_values&lt;double, merging_operator, 3&gt;(op_tmp,wrapper);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">return</span> merged_f;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">  554</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">make_plots</a>(<span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> &amp;<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>,<span class="keyword">const</span> std::string &amp;name=<span class="stringliteral">&quot;function&quot;</span>)<span class="keyword">const</span>{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordtype">double</span> width = <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;3&gt;::get_cell_min_width</a>()/2.0 - 1.e-3;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="namespacemadness.html#a76fd695fe36df96185f61dffd1dd3341">plot_plane</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>,<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>,name);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> start(0.0); start[0]=-width;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="classmadness_1_1Vector.html">coord_3d</a> end(0.0); end[0]=width;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="namespacemadness.html#adac485f0b8089f0031b4b061318981d6">plot_line</a>((<span class="stringliteral">&quot;line_&quot;</span>+name).c_str(),1000,start,end,<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="classsmooth.html#ada5526b3a06dbcd8a92702c19e2cca9e">  563</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsmooth.html#ada5526b3a06dbcd8a92702c19e2cca9e">test_1d</a>()<span class="keyword">const</span>{</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <a class="code" href="namespacemadness.html#a6631d36f4a1b6c9202d0056d459724b6">FunctionDefaults&lt;1&gt;::set_thresh</a>(1.<a class="code" href="test__sig_8cc.html#aed138f72d7301a9034a719a95c4903da">e</a>-5);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;1&gt;::set_k</a>(8);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="classmadness_1_1FunctionDefaults.html">FunctionDefaults&lt;1&gt;::set_cubic_cell</a>(-25.0,25.0);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_1d</a> <a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a> = <a class="code" href="namespacemadness.html#a8f559457e76e22ca919acb68d33b3872">real_factory_1d</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>).f(<a class="code" href="smooth_8h.html#a5ebd6d861290a2bce2664f4706f1dfca">test_1d_functor</a>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> coeffs(1), exponents(1);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        exponents(0<a class="code" href="ewald_8cc.html#a2442c8274ae11905a74c1bf95501af09">L</a>) =  1.0/(2.0*0.04);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        coeffs(0<a class="code" href="ewald_8cc.html#a2442c8274ae11905a74c1bf95501af09">L</a>) = <a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>((1.0/(2.0*0.04))/M_PI,0.5);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="classmadness_1_1SeparatedConvolution.html">SeparatedConvolution&lt;double,1&gt;</a> <a class="code" href="kain_8cc.html#ad9ea8219fce53cf10491311a9aac2fc0">op</a>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>, coeffs, exponents);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="classmadness_1_1Function.html">real_function_1d</a> sf = <a class="code" href="namespacemadness.html#aa30c05e5e017d5c630e8a2210a901a05">apply</a>(<a class="code" href="kain_8cc.html#ad9ea8219fce53cf10491311a9aac2fc0">op</a>,<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="navstokes__cosines_8cc.html#a99e053676e4acf89c7414f5c2723ab22">diff</a> = (<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>-sf).<a class="code" href="namespacemadness.html#a672a4a9d36a6a779bc6effac8d41bb62">norm2</a>();</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="classsmooth.html#a2c963943ec123fb418e5ea3a83cccd89">output</a>(<span class="stringliteral">&quot;||f - smoothed_f||_1D=&quot;</span>+<a class="code" href="namespacemadness.html#a152e0dfa50065a4289035481210a50d8">stringify</a>(<a class="code" href="navstokes__cosines_8cc.html#a99e053676e4acf89c7414f5c2723ab22">diff</a>));</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <a class="code" href="classmadness_1_1Vector.html">coord_1d</a> start; start[0]=-10.0;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="classmadness_1_1Vector.html">coord_1d</a> end; end[0]=10.0;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="namespacemadness.html#adac485f0b8089f0031b4b061318981d6">plot_line</a>(<span class="stringliteral">&quot;smoothed_1d&quot;</span>,1000,start,end,sf);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <a class="code" href="namespacemadness.html#adac485f0b8089f0031b4b061318981d6">plot_line</a>(<span class="stringliteral">&quot;noise_1d&quot;</span>,1000,start,end,<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a>);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="classsmooth.html#a35f729f07bb7ada5d56acc28e914aba0">  581</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classsmooth.html#a35f729f07bb7ada5d56acc28e914aba0">gauss_norm</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;exponent)<span class="keyword">const</span>{</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a>(exponent/M_PI,0.5*3.0);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="classsmooth.html#a2c963943ec123fb418e5ea3a83cccd89">  585</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsmooth.html#a2c963943ec123fb418e5ea3a83cccd89">output</a>(<span class="keyword">const</span> std::string &amp;msg)<span class="keyword">const</span>{</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>.<a class="code" href="classmadness_1_1World.html#a6cb4bff7804dc04970620fa61acd7876">rank</a>()==0) std::cout &lt;&lt; msg &lt;&lt; std::endl;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">  590</a></span>&#160;    <a class="code" href="classmadness_1_1World.html">World</a> &amp;<a class="code" href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">world</a>;</div><div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="classsmooth.html#af24963c61f717a97554af51931bb285b">  591</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#af24963c61f717a97554af51931bb285b">box_mask_</a>;</div><div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="classsmooth.html#a2652db75e07866c168745322236cfc83">  592</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a2652db75e07866c168745322236cfc83">mask_</a>;</div><div class="line"><a name="l00593"></a><span class="lineno"><a class="line" href="classsmooth.html#a4c72423b62094f6178eb8c4a7d503be8">  593</a></span>&#160;    <a class="code" href="classmadness_1_1Function.html">Function&lt;T,NDIM&gt;</a> <a class="code" href="classsmooth.html#a4c72423b62094f6178eb8c4a7d503be8">inv_mask_</a>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;};</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SRC_EXAMPLES_SMOOTH_H_ */</span><span class="preprocessor"></span></div><div class="ttc" id="tensor__macros_8h_html_a5d3f3617b9da31368b8c09f1b1ca0c61"><div class="ttname"><a href="tensor__macros_8h.html#a5d3f3617b9da31368b8c09f1b1ca0c61">ITERATOR</a></div><div class="ttdeci">#define ITERATOR(t, exp)</div><div class="ttdef"><b>Definition:</b> tensor_macros.h:249</div></div>
<div class="ttc" id="test__sig_8cc_html_a06ff3b9521de2f6a4e82b256e48e902a"><div class="ttname"><a href="test__sig_8cc.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a></div><div class="ttdeci">void d()</div><div class="ttdef"><b>Definition:</b> test_sig.cc:79</div></div>
<div class="ttc" id="structmunging__operator_html_afd90c31b55ee3a96baa8b8b1c26b8838"><div class="ttname"><a href="structmunging__operator.html#afd90c31b55ee3a96baa8b8b1c26b8838">munging_operator::operator()</a></div><div class="ttdeci">void operator()(const Key&lt; 3 &gt; &amp;key, real_tensor U, const real_tensor &amp;function, const real_tensor &amp;smoothed_function) const</div><div class="ttdef"><b>Definition:</b> smooth.h:73</div></div>
<div class="ttc" id="structmunging__operator_html_a63679b238d38baa254bc1b29d5f373f1"><div class="ttname"><a href="structmunging__operator.html#a63679b238d38baa254bc1b29d5f373f1">munging_operator::serialize</a></div><div class="ttdeci">void serialize(Archive &amp;ar)</div><div class="ttdef"><b>Definition:</b> smooth.h:88</div></div>
<div class="ttc" id="lda_8h_html_a38bdefe23f7d45690f9f1f8f1d6ba755"><div class="ttname"><a href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow</a></div><div class="ttdeci">static double pow(const double *a, const double *b)</div><div class="ttdef"><b>Definition:</b> lda.h:77</div></div>
<div class="ttc" id="smooth_8h_html_a1c4765f151bca6c2ad5971383fcbcf07"><div class="ttname"><a href="smooth_8h.html#a1c4765f151bca6c2ad5971383fcbcf07">make_log</a></div><div class="ttdeci">double make_log(double x)</div><div class="ttdef"><b>Definition:</b> smooth.h:21</div></div>
<div class="ttc" id="structdensity__mask__operator_html_a201a4848adc89fd12f79ddb31c84d8eb"><div class="ttname"><a href="structdensity__mask__operator.html#a201a4848adc89fd12f79ddb31c84d8eb">density_mask_operator::safety</a></div><div class="ttdeci">const double safety</div><div class="ttdef"><b>Definition:</b> smooth.h:267</div></div>
<div class="ttc" id="classmadness_1_1FunctionFactory_html"><div class="ttname"><a href="classmadness_1_1FunctionFactory.html">madness::FunctionFactory</a></div><div class="ttdoc">FunctionFactory implements the named-parameter idiom for Function. </div><div class="ttdef"><b>Definition:</b> funcimpl.h:68</div></div>
<div class="ttc" id="tensor__macros_8h_html_a73d72b72592cc30afbd4422632aa9c4c"><div class="ttname"><a href="tensor__macros_8h.html#a73d72b72592cc30afbd4422632aa9c4c">IND</a></div><div class="ttdeci">#define IND</div><div class="ttdef"><b>Definition:</b> tensor_macros.h:204</div></div>
<div class="ttc" id="classmadness_1_1FunctionDefaults_html"><div class="ttname"><a href="classmadness_1_1FunctionDefaults.html">madness::FunctionDefaults</a></div><div class="ttdoc">FunctionDefaults holds default paramaters as static class members. </div><div class="ttdef"><b>Definition:</b> funcdefaults.h:174</div></div>
<div class="ttc" id="smooth_8h_html_a853561c725ea623264b84ebc2a0cc47e"><div class="ttname"><a href="smooth_8h.html#a853561c725ea623264b84ebc2a0cc47e">mask_functor_box</a></div><div class="ttdeci">static double mask_functor_box(const coord_3d &amp;x)</div><div class="ttdef"><b>Definition:</b> smooth.h:60</div></div>
<div class="ttc" id="structasymptotic__density_html_acf4d00dcb81dea1e3c8c3ef7bc92ff6a"><div class="ttname"><a href="structasymptotic__density.html#acf4d00dcb81dea1e3c8c3ef7bc92ff6a">asymptotic_density::ionization_energy_</a></div><div class="ttdeci">const double ionization_energy_</div><div class="ttdef"><b>Definition:</b> smooth.h:106</div></div>
<div class="ttc" id="classsmooth_html_a2652db75e07866c168745322236cfc83"><div class="ttname"><a href="classsmooth.html#a2652db75e07866c168745322236cfc83">smooth::mask_</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; mask_</div><div class="ttdef"><b>Definition:</b> smooth.h:592</div></div>
<div class="ttc" id="SCFOperators_8h_html"><div class="ttname"><a href="SCFOperators_8h.html">SCFOperators.h</a></div><div class="ttdoc">Operators for the molecular HF and DFT code. </div></div>
<div class="ttc" id="structapply__kernel__helper_html_a28c74f7e45da54d409254ce762407d52"><div class="ttname"><a href="structapply__kernel__helper.html#a28c74f7e45da54d409254ce762407d52">apply_kernel_helper::safety_thresh_ptrho</a></div><div class="ttdeci">const double safety_thresh_ptrho</div><div class="ttdef"><b>Definition:</b> smooth.h:229</div></div>
<div class="ttc" id="namespacemadness_html_ac09d6cab7091e6938bdab587ac146bd4"><div class="ttname"><a href="namespacemadness.html#ac09d6cab7091e6938bdab587ac146bd4">madness::vecfuncT</a></div><div class="ttdeci">vector&lt; functionT &gt; vecfuncT</div><div class="ttdef"><b>Definition:</b> corepotential.cc:58</div></div>
<div class="ttc" id="structdensity__mask__operator_html_aee506bb2b0f6ef336458a2f43f32eb77"><div class="ttname"><a href="structdensity__mask__operator.html#aee506bb2b0f6ef336458a2f43f32eb77">density_mask_operator::density_mask_operator</a></div><div class="ttdeci">density_mask_operator(const double thresh)</div><div class="ttdef"><b>Definition:</b> smooth.h:248</div></div>
<div class="ttc" id="function__common__data_8h_html"><div class="ttname"><a href="function__common__data_8h.html">function_common_data.h</a></div></div>
<div class="ttc" id="smooth_8h_html_a6f2d2bf6d6ea1f87252def5f62f1e6b1"><div class="ttname"><a href="smooth_8h.html#a6f2d2bf6d6ea1f87252def5f62f1e6b1">munge</a></div><div class="ttdeci">static double munge(const double x)</div><div class="ttdef"><b>Definition:</b> smooth.h:307</div></div>
<div class="ttc" id="structasymptotic__density_html_a6c43a79ddc04e3a08b18fc0d97600a8f"><div class="ttname"><a href="structasymptotic__density.html#a6c43a79ddc04e3a08b18fc0d97600a8f">asymptotic_density::asymptotic_density</a></div><div class="ttdeci">asymptotic_density(const double &amp;ie)</div><div class="ttdef"><b>Definition:</b> smooth.h:94</div></div>
<div class="ttc" id="structsmooth_1_1inv__mask__functor_html_a0569645a35c04953d025abf557c32a51"><div class="ttname"><a href="structsmooth_1_1inv__mask__functor.html#a0569645a35c04953d025abf557c32a51">smooth::inv_mask_functor::cutoff_radius_</a></div><div class="ttdeci">const double cutoff_radius_</div><div class="ttdef"><b>Definition:</b> smooth.h:347</div></div>
<div class="ttc" id="classmadness_1_1Vector_html"><div class="ttname"><a href="classmadness_1_1Vector.html">madness::Vector</a></div><div class="ttdoc">A simple, fixed dimension vector. </div><div class="ttdef"><b>Definition:</b> vector.h:64</div></div>
<div class="ttc" id="classsmooth_html_aeb66e2abb61106bc65a63cd5323bc810"><div class="ttname"><a href="classsmooth.html#aeb66e2abb61106bc65a63cd5323bc810">smooth::linearize</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; linearize(const Function&lt; T, NDIM &gt; &amp;ln_rho) const</div><div class="ttdef"><b>Definition:</b> smooth.h:439</div></div>
<div class="ttc" id="smooth_8h_html_ad11f8c174dcc4ebcb02dc06a9bed4236"><div class="ttname"><a href="smooth_8h.html#ad11f8c174dcc4ebcb02dc06a9bed4236">mask_munging</a></div><div class="ttdeci">static double mask_munging(const double x)</div><div class="ttdef"><b>Definition:</b> smooth.h:297</div></div>
<div class="ttc" id="structasymptotic__slater_html_a9439e464a82e55b51047cfed1d314287"><div class="ttname"><a href="structasymptotic__slater.html#a9439e464a82e55b51047cfed1d314287">asymptotic_slater::asymptotic_slater</a></div><div class="ttdeci">asymptotic_slater(const double &amp;ipot_)</div><div class="ttdef"><b>Definition:</b> smooth.h:161</div></div>
<div class="ttc" id="namespacemadness_html_ac120a84f8cef7455f8d9bc68214e0c62"><div class="ttname"><a href="namespacemadness.html#ac120a84f8cef7455f8d9bc68214e0c62">madness::refine_to_common_level</a></div><div class="ttdeci">void refine_to_common_level(World &amp;world, std::vector&lt; Function&lt; T, NDIM &gt; &gt; &amp;vf, bool fence=true)</div><div class="ttdoc">refine all functions to a common (finest) level </div><div class="ttdef"><b>Definition:</b> vmra.h:179</div></div>
<div class="ttc" id="dielectric_8cc_html_a08d4c0acfdbc81d9f33f389cfe7839ea"><div class="ttname"><a href="dielectric_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a></div><div class="ttdeci">const double sigma</div><div class="ttdef"><b>Definition:</b> dielectric.cc:187</div></div>
<div class="ttc" id="structasymptotic__slater_html_a081f4939e54b70a1d69843b8e3b4e24f"><div class="ttname"><a href="structasymptotic__slater.html#a081f4939e54b70a1d69843b8e3b4e24f">asymptotic_slater::operator()</a></div><div class="ttdeci">double operator()(const coord_3d &amp;x) const</div><div class="ttdef"><b>Definition:</b> smooth.h:165</div></div>
<div class="ttc" id="smooth_8h_html_a405cb6872fc32872ac8cc2eac719aa3f"><div class="ttname"><a href="smooth_8h.html#a405cb6872fc32872ac8cc2eac719aa3f">mask_factor</a></div><div class="ttdeci">static double mask_factor</div><div class="ttdef"><b>Definition:</b> smooth.h:53</div></div>
<div class="ttc" id="classmadness_1_1SeparatedConvolution_html"><div class="ttname"><a href="classmadness_1_1SeparatedConvolution.html">madness::SeparatedConvolution&lt; T, NDIM &gt;</a></div></div>
<div class="ttc" id="classmadness_1_1Tensor_html_a02511feca6bd9e89ebaba8a241ba391c"><div class="ttname"><a href="classmadness_1_1Tensor.html#a02511feca6bd9e89ebaba8a241ba391c">madness::Tensor::absmax</a></div><div class="ttdeci">scalar_type absmax(long *ind=0) const</div><div class="ttdoc">Return the absolute maximum value (and if ind is non-null, its index) in the Tensor. </div><div class="ttdef"><b>Definition:</b> tensor.h:1741</div></div>
<div class="ttc" id="classsmooth_html_ac4a5bb598c23f202fe4c864b7d3b52d8"><div class="ttname"><a href="classsmooth.html#ac4a5bb598c23f202fe4c864b7d3b52d8">smooth::cut_oscillations</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; cut_oscillations(const Function&lt; T, NDIM &gt; &amp;f, const double &amp;cutoff, const size_t order) const</div><div class="ttdef"><b>Definition:</b> smooth.h:399</div></div>
<div class="ttc" id="structsmooth_1_1inv__mask__functor_html_af5770f4032f65db9b103b17a5f7907f8"><div class="ttname"><a href="structsmooth_1_1inv__mask__functor.html#af5770f4032f65db9b103b17a5f7907f8">smooth::inv_mask_functor::factor_</a></div><div class="ttdeci">const double factor_</div><div class="ttdef"><b>Definition:</b> smooth.h:346</div></div>
<div class="ttc" id="structasymptotic__density_html_a2f493e2aafc469c0b1527867a37a40d4"><div class="ttname"><a href="structasymptotic__density.html#a2f493e2aafc469c0b1527867a37a40d4">asymptotic_density::center_of_charge_</a></div><div class="ttdeci">const coord_3d center_of_charge_</div><div class="ttdef"><b>Definition:</b> smooth.h:107</div></div>
<div class="ttc" id="classsmooth_html_ada5526b3a06dbcd8a92702c19e2cca9e"><div class="ttname"><a href="classsmooth.html#ada5526b3a06dbcd8a92702c19e2cca9e">smooth::test_1d</a></div><div class="ttdeci">void test_1d() const</div><div class="ttdef"><b>Definition:</b> smooth.h:563</div></div>
<div class="ttc" id="structmerging__operator_html_a1b5aff1f8a9682eeaf037408475f8d14"><div class="ttname"><a href="structmerging__operator.html#a1b5aff1f8a9682eeaf037408475f8d14">merging_operator::cutoff</a></div><div class="ttdeci">const double cutoff</div><div class="ttdef"><b>Definition:</b> smooth.h:286</div></div>
<div class="ttc" id="testqm_8cc_html_aaf74a50adc11996232c499762bd570e8"><div class="ttname"><a href="testqm_8cc.html#aaf74a50adc11996232c499762bd570e8">mask</a></div><div class="ttdeci">double mask(const coord_1d &amp;r)</div><div class="ttdef"><b>Definition:</b> testqm.cc:53</div></div>
<div class="ttc" id="navstokes__cosines_8cc_html_a99e053676e4acf89c7414f5c2723ab22"><div class="ttname"><a href="navstokes__cosines_8cc.html#a99e053676e4acf89c7414f5c2723ab22">diff</a></div><div class="ttdeci">static Function&lt; T, NDIM &gt; diff(const Function&lt; T, NDIM &gt; &amp;f, int axis)</div><div class="ttdef"><b>Definition:</b> navstokes_cosines.cc:120</div></div>
<div class="ttc" id="classsmooth_html_a998915c296e37f2eb89b516a9f6cb420"><div class="ttname"><a href="classsmooth.html#a998915c296e37f2eb89b516a9f6cb420">smooth::make_sigma</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; make_sigma(const Function&lt; T, NDIM &gt; &amp;density) const</div><div class="ttdef"><b>Definition:</b> smooth.h:408</div></div>
<div class="ttc" id="structasymptotic__density_html_a908166e54cd5e886435abad2fb47e48e"><div class="ttname"><a href="structasymptotic__density.html#a908166e54cd5e886435abad2fb47e48e">asymptotic_density::operator()</a></div><div class="ttdeci">double operator()(const coord_3d &amp;x1) const</div><div class="ttdef"><b>Definition:</b> smooth.h:96</div></div>
<div class="ttc" id="classsmooth_html_a14d7bf0d758e7978ffec7f5efda1b6a8"><div class="ttname"><a href="classsmooth.html#a14d7bf0d758e7978ffec7f5efda1b6a8">smooth::world</a></div><div class="ttdeci">World &amp; world</div><div class="ttdef"><b>Definition:</b> smooth.h:590</div></div>
<div class="ttc" id="structapply__kernel__helper_html_a347a32f3468a49737fd1c275460e4041"><div class="ttname"><a href="structapply__kernel__helper.html#a347a32f3468a49737fd1c275460e4041">apply_kernel_helper::slater_apply</a></div><div class="ttdeci">madness::Tensor&lt; double &gt; slater_apply(const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;t, const madness::Key&lt; 3 &gt; &amp;key, const FunctionCommonData&lt; double, 3 &gt; cdata) const</div><div class="ttdef"><b>Definition:</b> smooth.h:188</div></div>
<div class="ttc" id="structapply__kernel__helper_1_1slater__kernel_html_a7dd6ae9e19dac9ebc1f481e17fe7c156"><div class="ttname"><a href="structapply__kernel__helper_1_1slater__kernel.html#a7dd6ae9e19dac9ebc1f481e17fe7c156">apply_kernel_helper::slater_kernel::operator()</a></div><div class="ttdeci">double operator()(const double &amp;rho) const</div><div class="ttdef"><b>Definition:</b> smooth.h:178</div></div>
<div class="ttc" id="classmadness_1_1Tensor_html_aab540a483f1ac657fd30d841118fefb3"><div class="ttname"><a href="classmadness_1_1Tensor.html#aab540a483f1ac657fd30d841118fefb3">madness::Tensor::emul</a></div><div class="ttdeci">Tensor&lt; T &gt; &amp; emul(const Tensor&lt; T &gt; &amp;t)</div><div class="ttdoc">Inplace multiply by corresponding elements of argument Tensor. </div><div class="ttdef"><b>Definition:</b> tensor.h:1785</div></div>
<div class="ttc" id="classsmooth_html_a704ee523ffad5dab6a3c66c41a3d8d3e"><div class="ttname"><a href="classsmooth.html#a704ee523ffad5dab6a3c66c41a3d8d3e">smooth::smooth</a></div><div class="ttdeci">smooth(World &amp;world, const double &amp;box_mask_factor, const double box_mask_cutoff)</div><div class="ttdef"><b>Definition:</b> smooth.h:318</div></div>
<div class="ttc" id="classsmooth_html_aaf67626f6f17a039b4a757144b4d04cf"><div class="ttname"><a href="classsmooth.html#aaf67626f6f17a039b4a757144b4d04cf">smooth::smooth_density</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; smooth_density(const Function&lt; T, NDIM &gt; &amp;density, const std::string &amp;msg=&quot;function&quot;)</div><div class="ttdef"><b>Definition:</b> smooth.h:422</div></div>
<div class="ttc" id="structmerging__operator_html_a634d5f03cacb8af4008ec630ae92061e"><div class="ttname"><a href="structmerging__operator.html#a634d5f03cacb8af4008ec630ae92061e">merging_operator::operator()</a></div><div class="ttdeci">madness::Tensor&lt; double &gt; operator()(const madness::Key&lt; 3 &gt; &amp;key, const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;t) const</div><div class="ttdef"><b>Definition:</b> smooth.h:274</div></div>
<div class="ttc" id="structslater__kernel_html_a19e1f8db9bcbe3e218a8598078bf3439"><div class="ttname"><a href="structslater__kernel.html#a19e1f8db9bcbe3e218a8598078bf3439">slater_kernel::slater_kernel</a></div><div class="ttdeci">slater_kernel()</div><div class="ttdef"><b>Definition:</b> smooth.h:127</div></div>
<div class="ttc" id="classmadness_1_1Tensor_html_a9014671cd3e69367d33fa3a2bfa47b63"><div class="ttname"><a href="classmadness_1_1Tensor.html#a9014671cd3e69367d33fa3a2bfa47b63">madness::Tensor::unaryop</a></div><div class="ttdeci">Tensor&lt; T &gt; &amp; unaryop(opT &amp;op)</div><div class="ttdoc">Inplace apply a unary function to each element of the tensor. </div><div class="ttdef"><b>Definition:</b> tensor.h:1779</div></div>
<div class="ttc" id="structsmooth_1_1inv__mask__functor_html"><div class="ttname"><a href="structsmooth_1_1inv__mask__functor.html">smooth::inv_mask_functor</a></div><div class="ttdef"><b>Definition:</b> smooth.h:336</div></div>
<div class="ttc" id="structasymptotic__density_html"><div class="ttname"><a href="structasymptotic__density.html">asymptotic_density</a></div><div class="ttdef"><b>Definition:</b> smooth.h:92</div></div>
<div class="ttc" id="namespacemadness_html_a76fd695fe36df96185f61dffd1dd3341"><div class="ttname"><a href="namespacemadness.html#a76fd695fe36df96185f61dffd1dd3341">madness::plot_plane</a></div><div class="ttdeci">void plot_plane(World &amp;world, const Function&lt; double, NDIM &gt; &amp;function, const std::string name)</div><div class="ttdef"><b>Definition:</b> funcplot.h:545</div></div>
<div class="ttc" id="smooth_8h_html_ae75aa03a85c5549b7c566e4565f0acda"><div class="ttname"><a href="smooth_8h.html#ae75aa03a85c5549b7c566e4565f0acda">slater_functor</a></div><div class="ttdeci">static double slater_functor(const coord_3d &amp;x)</div><div class="ttdef"><b>Definition:</b> smooth.h:47</div></div>
<div class="ttc" id="smooth_8h_html_a8ffabaced9d4f1a3f30a2a77f3345423"><div class="ttname"><a href="smooth_8h.html#a8ffabaced9d4f1a3f30a2a77f3345423">analytical_slater_functor</a></div><div class="ttdeci">static double analytical_slater_functor(double rho)</div><div class="ttdef"><b>Definition:</b> smooth.h:151</div></div>
<div class="ttc" id="classmadness_1_1Function_html_a097623c0188d0813e8d98be15fea2bcb"><div class="ttname"><a href="classmadness_1_1Function.html#a097623c0188d0813e8d98be15fea2bcb">madness::Function::refine</a></div><div class="ttdeci">const Function&lt; T, NDIM &gt; &amp; refine(bool fence=true) const</div><div class="ttdoc">Inplace autorefines the function using same test as for squaring. </div><div class="ttdef"><b>Definition:</b> mra.h:778</div></div>
<div class="ttc" id="structslater__kernel__apply_html_a2edf0f5e73e52662375c3092ea4c3410"><div class="ttname"><a href="structslater__kernel__apply.html#a2edf0f5e73e52662375c3092ea4c3410">slater_kernel_apply::slater_kernel_apply</a></div><div class="ttdeci">slater_kernel_apply(const apply_kernel_helper &amp;xc_)</div><div class="ttdef"><b>Definition:</b> smooth.h:237</div></div>
<div class="ttc" id="classsmooth_html_a3b287f9b3552de5100dbf0065784a4ea"><div class="ttname"><a href="classsmooth.html#a3b287f9b3552de5100dbf0065784a4ea">smooth::smooth</a></div><div class="ttdeci">smooth(World &amp;world)</div><div class="ttdef"><b>Definition:</b> smooth.h:315</div></div>
<div class="ttc" id="classsmooth_html"><div class="ttname"><a href="classsmooth.html">smooth</a></div><div class="ttdef"><b>Definition:</b> smooth.h:313</div></div>
<div class="ttc" id="structslater__kernel__apply_html_a2e4a6a6d7bbfd05e8b1ba3d5f2a0f2f9"><div class="ttname"><a href="structslater__kernel__apply.html#a2e4a6a6d7bbfd05e8b1ba3d5f2a0f2f9">slater_kernel_apply::cdata</a></div><div class="ttdeci">const FunctionCommonData&lt; double, 3 &gt; &amp; cdata</div><div class="ttdef"><b>Definition:</b> smooth.h:234</div></div>
<div class="ttc" id="structsmooth_1_1inv__mask__functor_html_aeb8f02431c32f7aabfdcee07bdc4a8f6"><div class="ttname"><a href="structsmooth_1_1inv__mask__functor.html#aeb8f02431c32f7aabfdcee07bdc4a8f6">smooth::inv_mask_functor::inv_mask_functor</a></div><div class="ttdeci">inv_mask_functor(const double &amp;factor, const double &amp;cutoff, const Vector&lt; double, NDIM &gt; shift)</div><div class="ttdef"><b>Definition:</b> smooth.h:339</div></div>
<div class="ttc" id="classmadness_1_1Tensor_html"><div class="ttname"><a href="classmadness_1_1Tensor.html">madness::Tensor&lt; double &gt;</a></div></div>
<div class="ttc" id="classsmooth_html_a4031d5e7c73c422f271a132405d8bfce"><div class="ttname"><a href="classsmooth.html#a4031d5e7c73c422f271a132405d8bfce">smooth::make_explog</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; make_explog(const Function&lt; T, NDIM &gt; &amp;f, const std::string &amp;msg=&quot;function&quot;) const</div><div class="ttdef"><b>Definition:</b> smooth.h:495</div></div>
<div class="ttc" id="classsmooth_html_a81b11b3934c624196dc66db76e89bdf9"><div class="ttname"><a href="classsmooth.html#a81b11b3934c624196dc66db76e89bdf9">smooth::merge_functions</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; merge_functions(const Function&lt; T, NDIM &gt; &amp;f, const Function&lt; T, NDIM &gt; &amp;sf, const double &amp;thresh) const</div><div class="ttdef"><b>Definition:</b> smooth.h:543</div></div>
<div class="ttc" id="structasymptotic__slater__kernel_html_a01732387cdeeed3d5a41e86499faa730"><div class="ttname"><a href="structasymptotic__slater__kernel.html#a01732387cdeeed3d5a41e86499faa730">asymptotic_slater_kernel::asymptotic_slater_kernel</a></div><div class="ttdeci">asymptotic_slater_kernel(const asymptotic_density &amp;tmp)</div><div class="ttdef"><b>Definition:</b> smooth.h:112</div></div>
<div class="ttc" id="classmadness_1_1Function_html"><div class="ttname"><a href="classmadness_1_1Function.html">madness::Function</a></div><div class="ttdoc">A multiresolution adaptive numerical function. </div><div class="ttdef"><b>Definition:</b> MolecularOrbitals.h:18</div></div>
<div class="ttc" id="madness__exception_8h_html_ae80fa540b62afc0e301296b3102ec106"><div class="ttname"><a href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a></div><div class="ttdeci">#define MADNESS_ASSERT(condition)</div><div class="ttdoc">Assert a condition that should be free of side-effects since in release builds this might be a no-op...</div><div class="ttdef"><b>Definition:</b> madness_exception.h:134</div></div>
<div class="ttc" id="helium__mp2_8cc_html_aa62318cb2637a9dfcb106b69c01d669c"><div class="ttname"><a href="helium__mp2_8cc.html#aa62318cb2637a9dfcb106b69c01d669c">shift</a></div><div class="ttdeci">static const double shift</div><div class="ttdef"><b>Definition:</b> helium_mp2.cc:55</div></div>
<div class="ttc" id="structsmooth_1_1inv__mask__functor_html_acd9de0a4cc83d57c08f00df40c927093"><div class="ttname"><a href="structsmooth_1_1inv__mask__functor.html#acd9de0a4cc83d57c08f00df40c927093">smooth::inv_mask_functor::inv_mask_functor</a></div><div class="ttdeci">inv_mask_functor(const double &amp;factor, const double &amp;cutoff)</div><div class="ttdef"><b>Definition:</b> smooth.h:338</div></div>
<div class="ttc" id="classmadness_1_1Function_html_aa7fe6957acf8b2a433581209fa9b44b6"><div class="ttname"><a href="classmadness_1_1Function.html#aa7fe6957acf8b2a433581209fa9b44b6">madness::Function::reconstruct</a></div><div class="ttdeci">const Function&lt; T, NDIM &gt; &amp; reconstruct(bool fence=true) const</div><div class="ttdoc">Reconstructs the function, transforming into scaling function basis. Possible non-blocking comm...</div><div class="ttdef"><b>Definition:</b> mra.h:738</div></div>
<div class="ttc" id="structslater__kernel_html_a5f67a5492cb7728283b7c3af7f0491ac"><div class="ttname"><a href="structslater__kernel.html#a5f67a5492cb7728283b7c3af7f0491ac">slater_kernel::pre</a></div><div class="ttdeci">double pre</div><div class="ttdef"><b>Definition:</b> smooth.h:148</div></div>
<div class="ttc" id="heat_8cc_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="heat_8cc.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">static const double c</div><div class="ttdef"><b>Definition:</b> heat.cc:76</div></div>
<div class="ttc" id="smooth_8h_html_ae40f714eb1e1602417beebd651af744c"><div class="ttname"><a href="smooth_8h.html#ae40f714eb1e1602417beebd651af744c">make_radius</a></div><div class="ttdeci">static double make_radius(const Vector&lt; double, NDIM &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> smooth.h:291</div></div>
<div class="ttc" id="classmadness_1_1FunctionCommonData_html_acb9785020960531390e70680562df2df"><div class="ttname"><a href="classmadness_1_1FunctionCommonData.html#acb9785020960531390e70680562df2df">madness::FunctionCommonData::quad_x</a></div><div class="ttdeci">Tensor&lt; double &gt; quad_x</div><div class="ttdoc">quadrature points </div><div class="ttdef"><b>Definition:</b> function_common_data.h:99</div></div>
<div class="ttc" id="structsmooth_1_1mask__functor_html_aa06145aec8ca6aec147dc908dfd0428f"><div class="ttname"><a href="structsmooth_1_1mask__functor.html#aa06145aec8ca6aec147dc908dfd0428f">smooth::mask_functor::mask_functor</a></div><div class="ttdeci">mask_functor(const double &amp;factor, const double &amp;cutoff, const Vector&lt; double, NDIM &gt; shift)</div><div class="ttdef"><b>Definition:</b> smooth.h:325</div></div>
<div class="ttc" id="structapply__kernel__helper_html_aef90e59eb82278ac2fad250482eb0dee"><div class="ttname"><a href="structapply__kernel__helper.html#aef90e59eb82278ac2fad250482eb0dee">apply_kernel_helper::asl</a></div><div class="ttdeci">asymptotic_slater asl</div><div class="ttdef"><b>Definition:</b> smooth.h:227</div></div>
<div class="ttc" id="structsmooth_1_1inv__mask__functor_html_aa39b9a160be5e008a869defa9c385d9f"><div class="ttname"><a href="structsmooth_1_1inv__mask__functor.html#aa39b9a160be5e008a869defa9c385d9f">smooth::inv_mask_functor::shift_</a></div><div class="ttdeci">const Vector&lt; double, NDIM &gt; shift_</div><div class="ttdef"><b>Definition:</b> smooth.h:348</div></div>
<div class="ttc" id="structsmooth_1_1mask__functor_html_a3a79e5250b3577ef148afb96b480c07a"><div class="ttname"><a href="structsmooth_1_1mask__functor.html#a3a79e5250b3577ef148afb96b480c07a">smooth::mask_functor::cutoff_radius_</a></div><div class="ttdeci">const double cutoff_radius_</div><div class="ttdef"><b>Definition:</b> smooth.h:333</div></div>
<div class="ttc" id="structasymptotic__slater_html_adfb25e91f0e28770713c353d52f0b2a0"><div class="ttname"><a href="structasymptotic__slater.html#adfb25e91f0e28770713c353d52f0b2a0">asymptotic_slater::prefactor</a></div><div class="ttdeci">const double prefactor</div><div class="ttdef"><b>Definition:</b> smooth.h:163</div></div>
<div class="ttc" id="structapply__kernel__helper_1_1slater__kernel_html_ae27069f7369c0ef0a30cbfada02a1608"><div class="ttname"><a href="structapply__kernel__helper_1_1slater__kernel.html#ae27069f7369c0ef0a30cbfada02a1608">apply_kernel_helper::slater_kernel::prefactor</a></div><div class="ttdeci">const double prefactor</div><div class="ttdef"><b>Definition:</b> smooth.h:183</div></div>
<div class="ttc" id="ewald_8cc_html_a2442c8274ae11905a74c1bf95501af09"><div class="ttname"><a href="ewald_8cc.html#a2442c8274ae11905a74c1bf95501af09">L</a></div><div class="ttdeci">static double L</div><div class="ttdef"><b>Definition:</b> ewald.cc:8</div></div>
<div class="ttc" id="structslater__kernel__apply_html_a51c223339cc7f975beaff79d9be34f45"><div class="ttname"><a href="structslater__kernel__apply.html#a51c223339cc7f975beaff79d9be34f45">slater_kernel_apply::operator()</a></div><div class="ttdeci">madness::Tensor&lt; double &gt; operator()(const madness::Key&lt; 3 &gt; &amp;key, const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;t) const</div><div class="ttdef"><b>Definition:</b> smooth.h:239</div></div>
<div class="ttc" id="smooth_8h_html_a135c4a45a23fef38931d37fff6aa15e1"><div class="ttname"><a href="smooth_8h.html#a135c4a45a23fef38931d37fff6aa15e1">xf</a></div><div class="ttdeci">static double xf(const coord_3d &amp;x)</div><div class="ttdef"><b>Definition:</b> smooth.h:40</div></div>
<div class="ttc" id="classsmooth_html_ab3207688ff1f41aa86cb5cbfc8be88e9"><div class="ttname"><a href="classsmooth.html#ab3207688ff1f41aa86cb5cbfc8be88e9">smooth::get_density_thresh</a></div><div class="ttdeci">double get_density_thresh() const</div><div class="ttdef"><b>Definition:</b> smooth.h:463</div></div>
<div class="ttc" id="structdensity__mask__operator_html_a330d1ee04c0bf795e3e95609511cca6e"><div class="ttname"><a href="structdensity__mask__operator.html#a330d1ee04c0bf795e3e95609511cca6e">density_mask_operator::operator()</a></div><div class="ttdeci">madness::Tensor&lt; double &gt; operator()(const madness::Key&lt; 3 &gt; &amp;key, const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;t) const</div><div class="ttdef"><b>Definition:</b> smooth.h:250</div></div>
<div class="ttc" id="namespacemadness_html_a51a0751f3bf95a504c43be228e01b7c2"><div class="ttname"><a href="namespacemadness.html#a51a0751f3bf95a504c43be228e01b7c2">madness::copy</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; copy(const Function&lt; T, NDIM &gt; &amp;f, const std::shared_ptr&lt; WorldDCPmapInterface&lt; Key&lt; NDIM &gt; &gt; &gt; &amp;pmap, bool fence=true)</div><div class="ttdoc">Create a new copy of the function with different distribution and optional fence. ...</div><div class="ttdef"><b>Definition:</b> mra.h:1907</div></div>
<div class="ttc" id="structasymptotic__slater__kernel_html"><div class="ttname"><a href="structasymptotic__slater__kernel.html">asymptotic_slater_kernel</a></div><div class="ttdef"><b>Definition:</b> smooth.h:110</div></div>
<div class="ttc" id="namespacemadness_html_adac485f0b8089f0031b4b061318981d6"><div class="ttname"><a href="namespacemadness.html#adac485f0b8089f0031b4b061318981d6">madness::plot_line</a></div><div class="ttdeci">void plot_line(World &amp;world, const char *filename, int npt, const Vector&lt; double, NDIM &gt; &amp;lo, const Vector&lt; double, NDIM &gt; &amp;hi, const opT &amp;op)</div><div class="ttdoc">Generates ASCII file tabulating f(r) at npoints along line r=lo,...,hi. </div><div class="ttdef"><b>Definition:</b> funcplot.h:388</div></div>
<div class="ttc" id="test__sig_8cc_html_aed138f72d7301a9034a719a95c4903da"><div class="ttname"><a href="test__sig_8cc.html#aed138f72d7301a9034a719a95c4903da">e</a></div><div class="ttdeci">void e()</div><div class="ttdef"><b>Definition:</b> test_sig.cc:75</div></div>
<div class="ttc" id="classsmooth_html_ac5e315de4de66e325c30fa847d9c076b"><div class="ttname"><a href="classsmooth.html#ac5e315de4de66e325c30fa847d9c076b">smooth::gaussian_smoothing</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; gaussian_smoothing(const Function&lt; T, NDIM &gt; &amp;f, const double &amp;eps=0.04, const std::string &amp;name=&quot;nooutput&quot;) const</div><div class="ttdef"><b>Definition:</b> smooth.h:518</div></div>
<div class="ttc" id="structapply__kernel__helper_html_a7ce9b09c07967d9e9eb6c34825da9b0a"><div class="ttname"><a href="structapply__kernel__helper.html#a7ce9b09c07967d9e9eb6c34825da9b0a">apply_kernel_helper::prefactor</a></div><div class="ttdeci">const double prefactor</div><div class="ttdef"><b>Definition:</b> smooth.h:225</div></div>
<div class="ttc" id="structasymptotic__density_html_a399d3cd984a23ce0715f2ff308648f71"><div class="ttname"><a href="structasymptotic__density.html#a399d3cd984a23ce0715f2ff308648f71">asymptotic_density::asymptotic_density</a></div><div class="ttdeci">asymptotic_density(const double &amp;ie, const coord_3d &amp;coc)</div><div class="ttdef"><b>Definition:</b> smooth.h:95</div></div>
<div class="ttc" id="classsmooth_html_af9233848eb0c46f4a2116316d6a67eb7"><div class="ttname"><a href="classsmooth.html#af9233848eb0c46f4a2116316d6a67eb7">smooth::merge_functions</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; merge_functions(const Function&lt; T, NDIM &gt; &amp;f, const Function&lt; T, NDIM &gt; &amp;sf, const Function&lt; T, NDIM &gt; &amp;mask, const std::string &amp;name=&quot;f&quot;) const</div><div class="ttdef"><b>Definition:</b> smooth.h:531</div></div>
<div class="ttc" id="smooth_8h_html_a4493ebd191b7393bb39e7aa937d0f0fd"><div class="ttname"><a href="smooth_8h.html#a4493ebd191b7393bb39e7aa937d0f0fd">cutoff_radius</a></div><div class="ttdeci">static double cutoff_radius</div><div class="ttdef"><b>Definition:</b> smooth.h:54</div></div>
<div class="ttc" id="structslater__kernel_html_aeb388845539249a7bf79b8292f67f65f"><div class="ttname"><a href="structslater__kernel.html#aeb388845539249a7bf79b8292f67f65f">slater_kernel::serialize</a></div><div class="ttdeci">void serialize(Archive &amp;ar)</div><div class="ttdef"><b>Definition:</b> smooth.h:146</div></div>
<div class="ttc" id="classmadness_1_1Function_html_afee4e84afef80e9fe70ebdf6f10199a8"><div class="ttname"><a href="classmadness_1_1Function.html#afee4e84afef80e9fe70ebdf6f10199a8">madness::Function::unaryop</a></div><div class="ttdeci">void unaryop(T(*f)(T))</div><div class="ttdoc">Inplace unary operation on function values. </div><div class="ttdef"><b>Definition:</b> mra.h:845</div></div>
<div class="ttc" id="h2dft_8cc_html_a9323bc3e282df6aafda394f0a9f93d6e"><div class="ttname"><a href="h2dft_8cc.html#a9323bc3e282df6aafda394f0a9f93d6e">gradop</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; real_derivative_3d &gt; &gt; gradop</div><div class="ttdef"><b>Definition:</b> h2dft.cc:53</div></div>
<div class="ttc" id="structapply__kernel__helper_html_a5ecec55d94e4a3bc96a3fb973001515d"><div class="ttname"><a href="structapply__kernel__helper.html#a5ecec55d94e4a3bc96a3fb973001515d">apply_kernel_helper::ipot</a></div><div class="ttdeci">const double ipot</div><div class="ttdef"><b>Definition:</b> smooth.h:226</div></div>
<div class="ttc" id="derivatives_8cc_html_a077a479820cb59b18ba5f9565d735e0f"><div class="ttname"><a href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a></div><div class="ttdeci">double(* f)(const coord_3d &amp;)</div><div class="ttdef"><b>Definition:</b> derivatives.cc:53</div></div>
<div class="ttc" id="structasymptotic__slater__kernel_html_aa0f75f251b7abf5c651b678069da2e4b"><div class="ttname"><a href="structasymptotic__slater__kernel.html#aa0f75f251b7abf5c651b678069da2e4b">asymptotic_slater_kernel::operator()</a></div><div class="ttdeci">double operator()(const coord_3d &amp;x) const</div><div class="ttdef"><b>Definition:</b> smooth.h:114</div></div>
<div class="ttc" id="namespacemadness_html_a152e0dfa50065a4289035481210a50d8"><div class="ttname"><a href="namespacemadness.html#a152e0dfa50065a4289035481210a50d8">madness::stringify</a></div><div class="ttdeci">static std::string stringify(T arg)</div><div class="ttdef"><b>Definition:</b> funcplot.h:897</div></div>
<div class="ttc" id="siam__example_8cc_html_a59ecf5f81b22d6ded9a5a193db5598fd"><div class="ttname"><a href="siam__example_8cc.html#a59ecf5f81b22d6ded9a5a193db5598fd">xi</a></div><div class="ttdeci">const double xi</div><div class="ttdoc">Exponent for delta function approx. </div><div class="ttdef"><b>Definition:</b> siam_example.cc:60</div></div>
<div class="ttc" id="structsmooth_1_1mask__functor_html_ab5510524de7611de0dc1d71cce6105bd"><div class="ttname"><a href="structsmooth_1_1mask__functor.html#ab5510524de7611de0dc1d71cce6105bd">smooth::mask_functor::factor_</a></div><div class="ttdeci">const double factor_</div><div class="ttdef"><b>Definition:</b> smooth.h:332</div></div>
<div class="ttc" id="structslater__kernel_html_aed4620d355d24f61c9d5068c5b2d2148"><div class="ttname"><a href="structslater__kernel.html#aed4620d355d24f61c9d5068c5b2d2148">slater_kernel::operator()</a></div><div class="ttdeci">void operator()(const Key&lt; 3 &gt; &amp;key, real_tensor U, const real_tensor &amp;rho, const real_tensor &amp;pt_rho) const</div><div class="ttdef"><b>Definition:</b> smooth.h:129</div></div>
<div class="ttc" id="nemo_8h_html"><div class="ttname"><a href="nemo_8h.html">nemo.h</a></div></div>
<div class="ttc" id="namespacemadness_html_a6631d36f4a1b6c9202d0056d459724b6"><div class="ttname"><a href="namespacemadness.html#a6631d36f4a1b6c9202d0056d459724b6">madness::set_thresh</a></div><div class="ttdeci">void set_thresh(World &amp;world, std::vector&lt; Function&lt; T, NDIM &gt; &gt; &amp;v, double thresh, bool fence=true)</div><div class="ttdoc">Sets the threshold in a vector of functions. </div><div class="ttdef"><b>Definition:</b> vmra.h:944</div></div>
<div class="ttc" id="smooth_8h_html_a6e5d4714300cac46f50f52a8abafd65b"><div class="ttname"><a href="smooth_8h.html#a6e5d4714300cac46f50f52a8abafd65b">make_exp</a></div><div class="ttdeci">double make_exp(double x)</div><div class="ttdef"><b>Definition:</b> smooth.h:26</div></div>
<div class="ttc" id="classmadness_1_1World_html_a6cb4bff7804dc04970620fa61acd7876"><div class="ttname"><a href="classmadness_1_1World.html#a6cb4bff7804dc04970620fa61acd7876">madness::World::rank</a></div><div class="ttdeci">ProcessID rank() const</div><div class="ttdoc">Returns the process rank in this World (same as MPI_Comm_rank()). </div><div class="ttdef"><b>Definition:</b> world.h:290</div></div>
<div class="ttc" id="testpdiff_8cc_html_a4b6a9b21ba2206c4a0a0bf1ed03c2653"><div class="ttname"><a href="testpdiff_8cc.html#a4b6a9b21ba2206c4a0a0bf1ed03c2653">NDIM</a></div><div class="ttdeci">static const std::size_t NDIM</div><div class="ttdef"><b>Definition:</b> testpdiff.cc:42</div></div>
<div class="ttc" id="classsmooth_html_a4c72423b62094f6178eb8c4a7d503be8"><div class="ttname"><a href="classsmooth.html#a4c72423b62094f6178eb8c4a7d503be8">smooth::inv_mask_</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; inv_mask_</div><div class="ttdef"><b>Definition:</b> smooth.h:593</div></div>
<div class="ttc" id="classmadness_1_1World_html"><div class="ttname"><a href="classmadness_1_1World.html">madness::World</a></div><div class="ttdoc">A parallel world class. </div><div class="ttdef"><b>Definition:</b> world.h:130</div></div>
<div class="ttc" id="classsmooth_html_a6d0ac83f3fa37fee72c80629419ea6c7"><div class="ttname"><a href="classsmooth.html#a6d0ac83f3fa37fee72c80629419ea6c7">smooth::make_inv_mask</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; make_inv_mask(const Function&lt; T, NDIM &gt; &amp;mask) const</div><div class="ttdef"><b>Definition:</b> smooth.h:487</div></div>
<div class="ttc" id="structapply__kernel__helper_1_1slater__kernel_html"><div class="ttname"><a href="structapply__kernel__helper_1_1slater__kernel.html">apply_kernel_helper::slater_kernel</a></div><div class="ttdef"><b>Definition:</b> smooth.h:177</div></div>
<div class="ttc" id="namespacemadness_html_a672a4a9d36a6a779bc6effac8d41bb62"><div class="ttname"><a href="namespacemadness.html#a672a4a9d36a6a779bc6effac8d41bb62">madness::norm2</a></div><div class="ttdeci">double norm2(World &amp;world, const std::vector&lt; Function&lt; T, NDIM &gt; &gt; &amp;v)</div><div class="ttdoc">Computes the 2-norm of a vector of functions. </div><div class="ttdef"><b>Definition:</b> vmra.h:630</div></div>
<div class="ttc" id="classsmooth_html_af24963c61f717a97554af51931bb285b"><div class="ttname"><a href="classsmooth.html#af24963c61f717a97554af51931bb285b">smooth::box_mask_</a></div><div class="ttdeci">const Function&lt; T, NDIM &gt; box_mask_</div><div class="ttdef"><b>Definition:</b> smooth.h:591</div></div>
<div class="ttc" id="structslater__kernel__apply_html"><div class="ttname"><a href="structslater__kernel__apply.html">slater_kernel_apply</a></div><div class="ttdef"><b>Definition:</b> smooth.h:232</div></div>
<div class="ttc" id="structmunging__operator_html_ae8b4a1e0dc3ca17d37162383fcb566be"><div class="ttname"><a href="structmunging__operator.html#ae8b4a1e0dc3ca17d37162383fcb566be">munging_operator::thresh_</a></div><div class="ttdeci">double thresh_</div><div class="ttdef"><b>Definition:</b> smooth.h:89</div></div>
<div class="ttc" id="structslater__kernel__apply_html_a5e2ac39a8fe9d121471ee6201d5b4bfa"><div class="ttname"><a href="structslater__kernel__apply.html#a5e2ac39a8fe9d121471ee6201d5b4bfa">slater_kernel_apply::xc</a></div><div class="ttdeci">const apply_kernel_helper * xc</div><div class="ttdef"><b>Definition:</b> smooth.h:236</div></div>
<div class="ttc" id="classsmooth_html_a2c963943ec123fb418e5ea3a83cccd89"><div class="ttname"><a href="classsmooth.html#a2c963943ec123fb418e5ea3a83cccd89">smooth::output</a></div><div class="ttdeci">void output(const std::string &amp;msg) const</div><div class="ttdef"><b>Definition:</b> smooth.h:585</div></div>
<div class="ttc" id="structmunging__operator_html_aa1c9bb6dddac0d6ee556e145b02a4262"><div class="ttname"><a href="structmunging__operator.html#aa1c9bb6dddac0d6ee556e145b02a4262">munging_operator::munging_operator</a></div><div class="ttdeci">munging_operator(const double thresh)</div><div class="ttdef"><b>Definition:</b> smooth.h:72</div></div>
<div class="ttc" id="classsmooth_html_a6e7bc943baf0195419e1bba8c75d1add"><div class="ttname"><a href="classsmooth.html#a6e7bc943baf0195419e1bba8c75d1add">smooth::make_mask</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; make_mask(const Function&lt; T, NDIM &gt; &amp;samplef, const double &amp;thresh) const</div><div class="ttdef"><b>Definition:</b> smooth.h:474</div></div>
<div class="ttc" id="classsmooth_html_afd853564ac2b479577cf941fed551276"><div class="ttname"><a href="classsmooth.html#afd853564ac2b479577cf941fed551276">smooth::munge_density</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; munge_density(const Function&lt; T, NDIM &gt; &amp;density) const</div><div class="ttdef"><b>Definition:</b> smooth.h:447</div></div>
<div class="ttc" id="classmadness_1_1FunctionFunctorInterface_html"><div class="ttname"><a href="classmadness_1_1FunctionFunctorInterface.html">madness::FunctionFunctorInterface</a></div><div class="ttdoc">Abstract base class interface required for functors used as input to Functions. </div><div class="ttdef"><b>Definition:</b> function_interface.h:59</div></div>
<div class="ttc" id="structmunging__operator_html_a5752bd2919249f1b50511e5908a2a7b9"><div class="ttname"><a href="structmunging__operator.html#a5752bd2919249f1b50511e5908a2a7b9">munging_operator::munging_operator</a></div><div class="ttdeci">munging_operator()</div><div class="ttdef"><b>Definition:</b> smooth.h:71</div></div>
<div class="ttc" id="smooth_8h_html_a5ebd6d861290a2bce2664f4706f1dfca"><div class="ttname"><a href="smooth_8h.html#a5ebd6d861290a2bce2664f4706f1dfca">test_1d_functor</a></div><div class="ttdeci">static double test_1d_functor(const coord_1d &amp;x)</div><div class="ttdef"><b>Definition:</b> smooth.h:36</div></div>
<div class="ttc" id="structsmooth_1_1mask__functor_html_a70a7019e4fedf53d92c39208d9b88821"><div class="ttname"><a href="structsmooth_1_1mask__functor.html#a70a7019e4fedf53d92c39208d9b88821">smooth::mask_functor::mask_functor</a></div><div class="ttdeci">mask_functor(const double &amp;factor, const double &amp;cutoff)</div><div class="ttdef"><b>Definition:</b> smooth.h:324</div></div>
<div class="ttc" id="structasymptotic__slater__kernel_html_a929572b050907018df651c898ddd51d1"><div class="ttname"><a href="structasymptotic__slater__kernel.html#a929572b050907018df651c898ddd51d1">asymptotic_slater_kernel::asymptotic_rho_</a></div><div class="ttdeci">const asymptotic_density asymptotic_rho_</div><div class="ttdef"><b>Definition:</b> smooth.h:123</div></div>
<div class="ttc" id="structsmooth_1_1mask__functor_html_a40f00bcae6fb8c5b1a389880e16fbb33"><div class="ttname"><a href="structsmooth_1_1mask__functor.html#a40f00bcae6fb8c5b1a389880e16fbb33">smooth::mask_functor::operator()</a></div><div class="ttdeci">double operator()(const Vector&lt; double, NDIM &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> smooth.h:326</div></div>
<div class="ttc" id="structmerging__operator_html_aab56718458367ffd4536724d49ebb325"><div class="ttname"><a href="structmerging__operator.html#aab56718458367ffd4536724d49ebb325">merging_operator::merging_operator</a></div><div class="ttdeci">merging_operator(const double c)</div><div class="ttdef"><b>Definition:</b> smooth.h:272</div></div>
<div class="ttc" id="structsmooth_1_1mask__functor_html"><div class="ttname"><a href="structsmooth_1_1mask__functor.html">smooth::mask_functor</a></div><div class="ttdef"><b>Definition:</b> smooth.h:322</div></div>
<div class="ttc" id="structapply__kernel__helper_html_a8536a0414683d16a119b185847b373f5"><div class="ttname"><a href="structapply__kernel__helper.html#a8536a0414683d16a119b185847b373f5">apply_kernel_helper::apply_kernel_helper</a></div><div class="ttdeci">apply_kernel_helper(const double &amp;ipot_)</div><div class="ttdef"><b>Definition:</b> smooth.h:175</div></div>
<div class="ttc" id="structslater__kernel_html_a3e87be22e969d5468cbec5bae9105835"><div class="ttname"><a href="structslater__kernel.html#a3e87be22e969d5468cbec5bae9105835">slater_kernel::slater_kernel</a></div><div class="ttdeci">slater_kernel(const double thresh)</div><div class="ttdef"><b>Definition:</b> smooth.h:128</div></div>
<div class="ttc" id="binaryop_8cc_html_ad77b1da747760e2d6abc1d07a92ddddf"><div class="ttname"><a href="binaryop_8cc.html#ad77b1da747760e2d6abc1d07a92ddddf">k</a></div><div class="ttdeci">static const long k</div><div class="ttdef"><b>Definition:</b> binaryop.cc:115</div></div>
<div class="ttc" id="funcplot_8h_html"><div class="ttname"><a href="funcplot_8h.html">funcplot.h</a></div><div class="ttdoc">Defines/implements plotting interface for functions. </div></div>
<div class="ttc" id="smooth_8h_html_a441d5e9fcf48aaf1bbf74b4c37d5d85b"><div class="ttname"><a href="smooth_8h.html#a441d5e9fcf48aaf1bbf74b4c37d5d85b">estimate_area</a></div><div class="ttdeci">double estimate_area(double x)</div><div class="ttdef"><b>Definition:</b> smooth.h:30</div></div>
<div class="ttc" id="structdensity__mask__operator_html"><div class="ttname"><a href="structdensity__mask__operator.html">density_mask_operator</a></div><div class="ttdef"><b>Definition:</b> smooth.h:246</div></div>
<div class="ttc" id="smooth_8h_html_a521b699706e122afff62769bb740bd27"><div class="ttname"><a href="smooth_8h.html#a521b699706e122afff62769bb740bd27">unitfunctor</a></div><div class="ttdeci">static double unitfunctor(const Vector&lt; double, NDIM &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> smooth.h:302</div></div>
<div class="ttc" id="structmerging__operator_html"><div class="ttname"><a href="structmerging__operator.html">merging_operator</a></div><div class="ttdef"><b>Definition:</b> smooth.h:270</div></div>
<div class="ttc" id="structasymptotic__slater_html_a5692b31002011d42aadcbd7221da91b5"><div class="ttname"><a href="structasymptotic__slater.html#a5692b31002011d42aadcbd7221da91b5">asymptotic_slater::ipot</a></div><div class="ttdeci">const double ipot</div><div class="ttdef"><b>Definition:</b> smooth.h:162</div></div>
<div class="ttc" id="kain_8cc_html_ad9ea8219fce53cf10491311a9aac2fc0"><div class="ttname"><a href="kain_8cc.html#ad9ea8219fce53cf10491311a9aac2fc0">op</a></div><div class="ttdeci">Tensor&lt; double &gt; op(const Tensor&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> kain.cc:508</div></div>
<div class="ttc" id="namespacemadness_html_a8e25cfffd1a97d7e7245986fea72493c"><div class="ttname"><a href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">madness::real_factory_3d</a></div><div class="ttdeci">FunctionFactory&lt; double, 3 &gt; real_factory_3d</div><div class="ttdef"><b>Definition:</b> functypedefs.h:93</div></div>
<div class="ttc" id="classmadness_1_1FunctionCommonData_html"><div class="ttname"><a href="classmadness_1_1FunctionCommonData.html">madness::FunctionCommonData&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="namespacemadness_html_a4699391f19a45f59c9e7fc7480ffb09d"><div class="ttname"><a href="namespacemadness.html#a4699391f19a45f59c9e7fc7480ffb09d">madness::project</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; project(const Function&lt; T, NDIM &gt; &amp;other, int k=FunctionDefaults&lt; NDIM &gt;::get_k(), double thresh=FunctionDefaults&lt; NDIM &gt;::get_thresh(), bool fence=true)</div><div class="ttdef"><b>Definition:</b> mra.h:2297</div></div>
<div class="ttc" id="structsmooth_1_1inv__mask__functor_html_a9f602ee33d44ddb476b95df24dba716e"><div class="ttname"><a href="structsmooth_1_1inv__mask__functor.html#a9f602ee33d44ddb476b95df24dba716e">smooth::inv_mask_functor::operator()</a></div><div class="ttdeci">double operator()(const Vector&lt; double, NDIM &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> smooth.h:340</div></div>
<div class="ttc" id="classmadness_1_1Function_html_a15df9cb8ef447b0f2089f1e829ad8f0b"><div class="ttname"><a href="classmadness_1_1Function.html#a15df9cb8ef447b0f2089f1e829ad8f0b">madness::Function::autorefine</a></div><div class="ttdeci">bool autorefine() const</div><div class="ttdoc">Retunrs. </div><div class="ttdef"><b>Definition:</b> mra.h:524</div></div>
<div class="ttc" id="classsmooth_html_a3fd26a59331e4b853f7d1a5c3e112ce3"><div class="ttname"><a href="classsmooth.html#a3fd26a59331e4b853f7d1a5c3e112ce3">smooth::smooth_sigma</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; smooth_sigma(const Function&lt; T, NDIM &gt; &amp;density)</div><div class="ttdef"><b>Definition:</b> smooth.h:353</div></div>
<div class="ttc" id="namespacemadness_html_a8f559457e76e22ca919acb68d33b3872"><div class="ttname"><a href="namespacemadness.html#a8f559457e76e22ca919acb68d33b3872">madness::real_factory_1d</a></div><div class="ttdeci">FunctionFactory&lt; double, 1 &gt; real_factory_1d</div><div class="ttdef"><b>Definition:</b> functypedefs.h:91</div></div>
<div class="ttc" id="testcosine_8cc_html_a9eab80aaf4be993b3a2cfd79b55f7fb9"><div class="ttname"><a href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a></div><div class="ttdeci">static const double thresh</div><div class="ttdef"><b>Definition:</b> testcosine.cc:13</div></div>
<div class="ttc" id="classsmooth_html_a416c0ace94732dd9a6df363526ae4a01"><div class="ttname"><a href="classsmooth.html#a416c0ace94732dd9a6df363526ae4a01">smooth::make_density_mask</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; make_density_mask(const Function&lt; T, NDIM &gt; &amp;density) const</div><div class="ttdef"><b>Definition:</b> smooth.h:453</div></div>
<div class="ttc" id="smooth_8h_html_a25e8e8c37590dd32cd861930584b3790"><div class="ttname"><a href="smooth_8h.html#a25e8e8c37590dd32cd861930584b3790">RHOMIN</a></div><div class="ttdeci">static double RHOMIN</div><div class="ttdef"><b>Definition:</b> smooth.h:19</div></div>
<div class="ttc" id="classsmooth_html_a35f729f07bb7ada5d56acc28e914aba0"><div class="ttname"><a href="classsmooth.html#a35f729f07bb7ada5d56acc28e914aba0">smooth::gauss_norm</a></div><div class="ttdeci">double gauss_norm(const double &amp;exponent) const</div><div class="ttdef"><b>Definition:</b> smooth.h:581</div></div>
<div class="ttc" id="structslater__kernel_html_ab00a615a50c92b1cce87786a0078fe30"><div class="ttname"><a href="structslater__kernel.html#ab00a615a50c92b1cce87786a0078fe30">slater_kernel::thresh_</a></div><div class="ttdeci">double thresh_</div><div class="ttdef"><b>Definition:</b> smooth.h:147</div></div>
<div class="ttc" id="structasymptotic__slater_html"><div class="ttname"><a href="structasymptotic__slater.html">asymptotic_slater</a></div><div class="ttdef"><b>Definition:</b> smooth.h:159</div></div>
<div class="ttc" id="structapply__kernel__helper_html_a8bdfb403cf388d184a5eea9825a49b15"><div class="ttname"><a href="structapply__kernel__helper.html#a8bdfb403cf388d184a5eea9825a49b15">apply_kernel_helper::safety_thresh_rho</a></div><div class="ttdeci">const double safety_thresh_rho</div><div class="ttdef"><b>Definition:</b> smooth.h:228</div></div>
<div class="ttc" id="namespacemadness_html_aa30c05e5e017d5c630e8a2210a901a05"><div class="ttname"><a href="namespacemadness.html#aa30c05e5e017d5c630e8a2210a901a05">madness::apply</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; apply(const Derivative&lt; T, NDIM &gt; &amp;D, const Function&lt; T, NDIM &gt; &amp;f, bool fence=true)</div><div class="ttdoc">Applies derivative operator to function (for syntactic equivalence to integral operator apply) ...</div><div class="ttdef"><b>Definition:</b> derivative.h:722</div></div>
<div class="ttc" id="smooth_8h_html_acc9bde5c250cd055cbf426159a927fe3"><div class="ttname"><a href="smooth_8h.html#acc9bde5c250cd055cbf426159a927fe3">r2</a></div><div class="ttdeci">static double r2(const coord_3d &amp;x)</div><div class="ttdef"><b>Definition:</b> smooth.h:43</div></div>
<div class="ttc" id="classsmooth_html_aa6f70307d0a11c1a546595a87d26d8af"><div class="ttname"><a href="classsmooth.html#aa6f70307d0a11c1a546595a87d26d8af">smooth::smooth_density_from_orbitals</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; smooth_density_from_orbitals(const std::vector&lt; Function&lt; T, NDIM &gt;&gt; &amp;orbitals) const</div><div class="ttdef"><b>Definition:</b> smooth.h:376</div></div>
<div class="ttc" id="classmadness_1_1Key_html"><div class="ttname"><a href="classmadness_1_1Key.html">madness::Key</a></div><div class="ttdoc">Key is the index for a node of the 2^NDIM-tree. </div><div class="ttdef"><b>Definition:</b> key.h:66</div></div>
<div class="ttc" id="structslater__kernel_html"><div class="ttname"><a href="structslater__kernel.html">slater_kernel</a></div><div class="ttdef"><b>Definition:</b> smooth.h:126</div></div>
<div class="ttc" id="structapply__kernel__helper_html"><div class="ttname"><a href="structapply__kernel__helper.html">apply_kernel_helper</a></div><div class="ttdef"><b>Definition:</b> smooth.h:172</div></div>
<div class="ttc" id="structmunging__operator_html"><div class="ttname"><a href="structmunging__operator.html">munging_operator</a></div><div class="ttdef"><b>Definition:</b> smooth.h:70</div></div>
<div class="ttc" id="structsmooth_1_1mask__functor_html_a1893f1f198ce68433afb0e9fbdf16459"><div class="ttname"><a href="structsmooth_1_1mask__functor.html#a1893f1f198ce68433afb0e9fbdf16459">smooth::mask_functor::shift_</a></div><div class="ttdeci">const Vector&lt; double, NDIM &gt; shift_</div><div class="ttdef"><b>Definition:</b> smooth.h:334</div></div>
<div class="ttc" id="classsmooth_html_a3dbbc44035f14e11f93232bc5e014f37"><div class="ttname"><a href="classsmooth.html#a3dbbc44035f14e11f93232bc5e014f37">smooth::make_plots</a></div><div class="ttdeci">void make_plots(const Function&lt; T, NDIM &gt; &amp;f, const std::string &amp;name=&quot;function&quot;) const</div><div class="ttdef"><b>Definition:</b> smooth.h:554</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 6 2020 16:37:35 for MADNESS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
